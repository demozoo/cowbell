(function(){function fa(r,Q){function x(a){if(V){ga=0;J=a;Da(Ea);v();f=J;b[1]=55;b[56325]=0;for(a=1E5;0<=a&&!R();a--);ha[J]||b[56325]?(b[56325]||(b[56324]=36,b[56325]=64),W=(b[56324]+256*b[56325])/F):W=r/Fa;0==ia?K=2>(b[1]&3)?b[65534]+256*b[65535]:b[788]+256*b[789]:(K=ia,57344<=K&&55==b[1]&&(b[1]=53));Da(K);X=1;ended=playtime=L=S=0;ga=1}}function Da(b){g=b;a=q=p=f=0;d=255}function R(){m=b[g];l=2;y=0;if(m&1){switch(m&31){case 1:case 3:c=b[b[++g]+p]+256*b[b[g]+p+1];l=6;break;case 17:case 19:c=b[b[++g]]+
256*b[b[g]+1]+q;l=6;break;case 25:case 31:c=b[++g]+256*b[++g]+q;l=5;break;case 29:c=b[++g]+256*b[++g]+p;l=5;break;case 13:case 15:c=b[++g]+256*b[++g];l=4;break;case 21:c=b[++g]+p;l=4;break;case 5:case 7:c=b[++g];l=3;break;case 23:c=b[++g]+q;l=4;break;case 9:case 11:c=++g,l=2}c&=65535;switch(m&224){case 96:k=f;f+=b[c]+(a&1);a&=20;a|=f&128|255<f;f&=255;a|=!f<<1|(!((k^b[c])&128)&&(k^f)&128)>>1;break;case 224:k=f;f-=b[c]+!(a&1);a&=20;a|=f&128|0<=f;f&=255;a|=!f<<1|((k^b[c])&128&&(k^f)&128)>>1;break;case 192:k=
f-b[c];a&=124;a|=!(k&255)<<1|k&128|0<=k;break;case 0:f|=b[c];a&=125;a|=!f<<1|f&128;break;case 32:f&=b[c];a&=125;a|=!f<<1|f&128;break;case 64:f^=b[c];a&=125;a|=!f<<1|f&128;break;case 160:f=b[c];a&=125;a|=!f<<1|f&128;3==(m&3)&&(p=f);break;case 128:b[c]=f&(3==(m&3)?p:255),y=c}}else if(m&2){switch(m&31){case 30:c=b[++g]+256*b[++g]+(128!=(m&192)?p:q);l=5;break;case 14:c=b[++g]+256*b[++g];l=4;break;case 22:c=b[++g]+(128!=(m&192)?p:q);l=4;break;case 6:c=b[++g];l=3;break;case 2:c=++g,l=2}c&=65535;switch(m&
224){case 0:a&=254;case 32:10==(m&15)?(f=(f<<1)+(a&1),a&=60,a|=f&128|255<f,f&=255,a|=!f<<1):(k=(b[c]<<1)+(a&1),a&=60,a|=k&128|255<k,k&=255,a|=!k<<1,b[c]=k,l+=2);break;case 64:a&=254;case 96:10==(m&15)?(k=f,f=(f>>1)+128*(a&1),a&=60,a|=f&128|k&1,f&=255,a|=!f<<1):(k=(b[c]>>1)+128*(a&1),a&=60,a|=k&128|b[c]&1,k&=255,a|=!k<<1,b[c]=k,l+=2);break;case 192:m&4?(b[c]--,b[c]&=255,a&=125,a|=!b[c]<<1|b[c]&128,l+=2):(p--,p&=255,a&=125,a|=!p<<1|p&128);break;case 160:if(10!=(m&15))p=b[c];else if(m&16){p=d;break}else p=
f;a&=125;a|=!p<<1|p&128;break;case 128:m&4?(b[c]=p,y=c):m&16?d=p:(f=p,a&=125,a|=!f<<1|f&128);break;case 224:m&4&&(b[c]++,b[c]&=255,a&=125,a|=!b[c]<<1|b[c]&128,l+=2)}}else if(8==(m&12))switch(m&240){case 96:d++;d&=255;f=b[256+d];a&=125;a|=!f<<1|f&128;l=4;break;case 192:q++;q&=255;a&=125;a|=!q<<1|q&128;break;case 224:p++;p&=255;a&=125;a|=!p<<1|p&128;break;case 128:q--;q&=255;a&=125;a|=!q<<1|q&128;break;case 0:b[256+d]=a;d--;d&=255;l=3;break;case 32:d++;d&=255;a=b[256+d];l=4;break;case 64:b[256+d]=f;
d--;d&=255;l=3;break;case 144:f=q;a&=125;a|=!f<<1|f&128;break;case 160:q=f;a&=125;a|=!q<<1|q&128;break;default:a=ja[m>>5]&32?a|ja[m>>5]&223:a&255-(ja[m>>5]&223)}else if(16==(m&31))g++,k=b[g],k&128&&(k-=256),m&32?a&Ga[m>>6]&&(g+=k,l=3):a&Ga[m>>6]||(g+=k,l=3);else{switch(m&31){case 0:c=++g;l=2;break;case 28:c=b[++g]+256*b[++g]+p;l=5;break;case 12:c=b[++g]+256*b[++g];l=4;break;case 20:c=b[++g]+p;l=4;break;case 4:c=b[++g],l=3}c&=65535;switch(m&224){case 0:b[256+d]=g%256;d--;d&=255;b[256+d]=g/256;d--;
d&=255;b[256+d]=a;d--;d&=255;g=b[65534]+256*b[65535]-1;l=7;break;case 32:m&15?(a&=61,a|=b[c]&192|!(f&b[c])<<1):(b[256+d]=(g+2)%256,d--,d&=255,b[256+d]=(g+2)/256,d--,d&=255,g=b[c]+256*b[c+1]-1,l=6);break;case 64:if(m&15)g=c-1,l=3;else{if(255<=d)return 254;d++;d&=255;a=b[256+d];d++;d&=255;k=b[256+d];d++;d&=255;g=b[256+d]+256*k-1;l=6}break;case 96:if(m&15)g=b[c]+256*b[c+1]-1,l=5;else{if(255<=d)return 255;d++;d&=255;k=b[256+d];d++;d&=255;g=b[256+d]+256*k-1;l=6}break;case 192:k=q-b[c];a&=124;a|=!(k&255)<<
1|k&128|0<=k;break;case 224:k=p-b[c];a&=124;a|=!(k&255)<<1|k&128|0<=k;break;case 160:q=b[c];a&=125;a|=!q<<1|q&128;break;case 128:b[c]=q,y=c}}g++;g&=65535;return 0}function v(){for(var a=54272;55295>=a;a++)b[a]=0;for(a=56832;57343>=a;a++)b[a]=0;for(a=0;9>a;a++)s[a]=ka,D[a]=t[a]=la[a]=ma[a]=0}function na(a,c){B=Y=0;for(var e=a*T;e<(a+1)*T;e++){oa=s[e]&Z;E=c+7*(e-a*T);I=b[E+4];z=I&240;U=I&Ua;M=b[E+6];h=0;oa!=(I&Z)&&(oa?s[e]&=255-(Z|N|$):(s[e]=Z|N|$,(M&15)>(ma[e]&15)&&(h=1)));ma[e]=M;D[e]+=F;32768<=D[e]&&
(D[e]-=32768);u=s[e]&N?b[E+5]>>4:s[e]&$?b[E+5]&15:M&15;aa=Va[u];u=Wa[u];if(D[e]>=aa&&(D[e]<aa+F&&0==h)&&(D[e]-=aa,s[e]&N||++la[e]==Xa[t[e]])){if(!(s[e]&ka))if(s[e]&N)t[e]+=u,255<=t[e]&&(t[e]=255,s[e]&=255-N);else if(!(s[e]&$)||t[e]>(M>>4)+(M&240))t[e]-=u,0>=t[e]&&0!=t[e]+u&&(t[e]=0,s[e]|=ka);la[e]=0}t[e]&=255;O=(b[E]+256*b[E+1])*F;U||I&Ya&&Ha[a]?w[e]=0:(w[e]+=O,16777215<w[e]&&(w[e]-=16777216));pa=w[e]&8388608;Ha[a]=pa>(qa[e]&8388608)?1:0;if(z&Za){h=Ia[e];if((w[e]&1048576)!=(qa[e]&1048576)||1048576<=
O)u=h&4194304^(h&131072)<<5,h=(h<<1)+(0<u||U)&8388607,Ia[e]=h;n=z&112?0:((h&1048576)>>5)+((h&262144)>>4)+((h&16384)>>1)+((h&2048)<<1)+((h&512)<<2)+((h&32)<<5)+((h&4)<<7)+((h&1)<<8)}else z&Ja?(C=16*(b[E+2]+256*(b[E+3]&15)),h=O>>9,0<C&&C<h&&(C=h),h^=65535,C>h&&(C=h),h=w[e]>>8,z==Ja?(u=256/(O>>16),U?n=65535:h<C?(G=(65535-C)*u,65535<G&&(G=65535),n=G-(C-h)*u,0>n&&(n=0)):(G=C*u,65535<G&&(G=65535),n=(65535-h)*u-G,0<=n&&(n=65535),n&=65535)):(n=h>=C||U?65535:0,z&ra?z&sa?n=n?ba(e,PulseTriSaw_8580,h>>4,1):0:
(h=w[e]^(I&Ka?ta[a]:0),n=n?ba(e,PulseSaw_8580,(h^(h&8388608?16777215:0))>>11,0):0):z&sa&&(n=n?ba(e,PulseSaw_8580,h>>4,1):0))):z&sa?(n=w[e]>>8,z&ra?n=ba(e,TriSaw_8580,n>>4,1):(u=O/18874368,n+=n*u,65535<n&&(n=65535-(n-65536)/u))):z&ra&&(h=w[e]^(I&Ka?ta[a]:0),n=(h^(h&8388608?16777215:0))>>7);z?La[e]=n:n=La[e];qa[e]=w[e];ta[a]=pa;if(b[c+23]&$a[e])Y+=(n-32768)*(t[e]/256);else if(2!=e%T||!(b[c+24]&ab))B+=(n-32768)*(t[e]/256)}b[1]&3&&(b[c+27]=n>>8);b[c+28]=t[3];H=(b[c+21]&7)/8+b[c+22]+0.2;8580==ca?(H=1-
Math.exp(H*bb),ua=Math.pow(2,(4-(b[c+23]>>4))/8)):(H=24>H?0.035:1-1.263*Math.exp(H*cb),ua=95<b[c+23]?8/(b[c+23]>>4):1.41);h=Y+va[a]*ua+wa[a];b[c+24]&db&&(B-=h);h=va[a]-h*H;va[a]=h;b[c+24]&eb&&(B-=h);h=wa[a]+h*H;wa[a]=h;b[c+24]&fb&&(B+=h);return B/Ma*(b[c+24]&15)}function ba(a,b,c,f){f&&6581==ca&&(c&=2047);Na=(b[c]+Oa[a])/2;Oa[a]=b[c];return Na}function xa(a,b,c,f){for(var d=0;4096>d;d++){for(var g=a[d]=0;12>g;g++){for(var h=0,k=0;12>k;k++)h+=b/Math.pow(c,Math.abs(k-g))*((d>>k&1)-0.5);a[d]+=h>=f?Math.pow(2,
g):0}a[d]*=12}}this.author="Hermit";this.sourcecode="http://hermit.sidrip.com";this.version="0.9.1";this.year="2016";this.loadinit=function(a,c){V=0;v();J=c;var e=new XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=function(){var a=new Uint8Array(e.response),c,d;d=a[7];da=a[8]+a[9]?256*a[8]+a[9]:a[d]+256*a[d+1];for(c=0;32>c;c++)ha[31-c]=a[18+(c>>3)]&Math.pow(2,7-c%8);for(c=0;c<b.length;c++)b[c]=0;for(c=d+2;c<a.byteLength;c++)da+c-(d+2)<b.length&&(b[da+c-(d+2)]=a[c]);d=1;for(c=
0;32>c;c++)d=0!=d?ya[c]=a[22+c]:ya[c]=0;d=1;for(c=0;32>c;c++)d=0!=d?za[c]=a[54+c]:za[c]=0;d=1;for(c=0;32>c;c++)d=0!=d?Aa[c]=a[86+c]:Aa[c]=0;Ea=a[10]+a[11]?256*a[10]+a[11]:da;K=ia=256*a[12]+a[13];Pa=a[15];ea[0]=32<=(a[119]&48)?8580:6581;ea[1]=128<=(a[119]&192)?8580:6581;ea[2]=3<=(a[118]&3)?8580:6581;A[1]=66<=a[122]&&(128>a[122]||224<=a[122])?53248+16*a[122]:0;A[2]=66<=a[123]&&(128>a[123]||224<=a[123])?53248+16*a[123]:0;Qa=1+(0<A[1])+(0<A[2]);V=1;null!==Ba&&Ba();x(J)};e.send(null)};this.gettitle=function(){return String.fromCharCode.apply(null,
ya)};this.getauthor=function(){return String.fromCharCode.apply(null,za)};this.getinfo=function(){return String.fromCharCode.apply(null,Aa)};this.getsubtunes=function(){return Pa};this.getprefmodel=function(){return ea[0]};this.getmodel=function(){return ca};this.getoutput=function(){return B/Ma*(b[54296]&15)};this.getplaytime=function(){return parseInt(playtime)};this.setmodel=function(a){ca=a};this.setvolume=function(a){Ra=a};this.setloadcallback=function(a){Ba=a};this.setstartcallback=function(a){};
this.setendcallback=function(a,b){endcallback=a;Ca=b};var Fa=50,T=3,Ma=1048576*T,fa=[0,1,0.6,0.4],ya=new Uint8Array(32),za=new Uint8Array(32),Aa=new Uint8Array(32),ha=new Uint8Array(32),da=4096,Ea=4096,ia=4099,K=4099,J=0,Pa=1,Ca=0,ea=[8580,8580,8580],ca=8580,A=[54272,0,0],b=new Uint8Array(65536),V=0,ga=0,S=0,Ba=null;endcallback=null;ended=playtime=0;var F=985248/r,W=r/Fa,X=1,Ra=1,L=0,Sa,Qa=1,P=0;this.playFrame=function(){if(V&&ga&&(X--,playtime+=1/r,0>=X&&(X=W,S=0,g=K,d=255),0==S)){for(;L<=F;){Sa=
g;if(254<=R()){S=1;break}else L+=l;if(1<(b[1]&3)&&57344>Sa&&(59953==g||60033==g)){S=1;break}if((56325==c||56324==c)&&b[1]&3&&ha[J])W=(b[56324]+256*b[56325])/F;54304<=y&&55296>y&&b[1]&3&&!(A[1]<=y&&y<A[1]+31)&&!(A[2]<=y&&y<A[2]+31)&&(b[y&54303]=b[y]);54276==c&&!(b[54276]&1)&&(s[0]&=62);54283==c&&!(b[54283]&1)&&(s[1]&=62);54290==c&&!(b[54290]&1)&&(s[2]&=62)}L-=F}0<Ca&&(parseInt(playtime)==parseInt(Ca)&&null!==endcallback&&0==ended)&&(ended=1,endcallback());P=na(0,54272);A[1]&&(P+=na(1,A[1]));A[2]&&
(P+=na(2,A[2]));return P*Ra*fa[Qa]+(Math.random()*Q-Q/2)};this.init=x;var ja=[1,33,4,36,0,64,8,40],Ga=[128,64,1,2],g=0,f=0,k=0,p=0,q=0,d=255,m=0,c=0,a=0,l=0,y=0,Z=1,Ya=2,Ka=4,Ua=8,ra=16,sa=32,Ja=64,Za=128,ka=16,$=64,N=128,$a=[1,2,4,1,2,4,1,2,4],fb=16,eb=32,db=64,ab=128,s=[0,0,0,0,0,0,0,0,0],D=[0,0,0,0,0,0,0,0,0],t=[0,0,0,0,0,0,0,0,0],la=[0,0,0,0,0,0,0,0,0],ma=[0,0,0,0,0,0,0,0,0],w=[0,0,0,0,0,0,0,0,0],qa=[0,0,0,0,0,0,0,0,0],Ha=[0,0,0],ta=[0,0,0],Ia=[8388600,8388600,8388600,8388600,8388600,8388600,
8388600,8388600,8388600],La=[0,0,0,0,0,0,0,0,0],Oa=[0,0,0,0,0,0,0,0,0],Na,wa=[0,0,0],va=[0,0,0],bb=-306.640625/r,cb=-490.625/r,oa,E,I,z,U,aa,u,M,O,pa,h,C,G,n,H,ua,Y,B;TriSaw_8580=Array(4096);xa(TriSaw_8580,0.8,2.4,0.64);PulseSaw_8580=Array(4096);xa(PulseSaw_8580,1.4,1.9,0.68);PulseTriSaw_8580=Array(4096);xa(PulseTriSaw_8580,0.8,2.5,0.64);var Ta=Math.max(F,9),Va=[Ta,32,63,95,149,220,267,313,392,977,1954,3126,3907,11720,19532,31251],Wa=[Math.ceil(Ta/9),1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],Xa=[1,30,30,30,
30,30,30,16,16,16,16,16,16,16,16,8,8,8,8,8,8,8,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
1,1,1,1,1,1,1]}function v(r,Q,x,v){var R=5E-4;x&&x.backgroundNoise&&(R=x.backgroundNoise);v&&v.duration?(this.duration=v.duration,this.frameCount=this.duration*Q.sampleRate):(this.duration=60,this.frameCount=null);this.sidPlayer=new fa(Q.sampleRate,R);this.url=r}v.prototype.load=function(r){var v=this;this.sidPlayer.setloadcallback(function(){v.channelCount=1;v.seekable=!1;r()});this.sidPlayer.loadinit(this.url,0)};v.prototype.generateAudio=function(r){var v=r.getChannelData(0);if(null===this.frameCount)r=
r.length;else{var x=Math.max(0,this.frameCount-this.framesRendered);r=Math.min(r.length,x)}for(x=0;x<r;x++)v[x]=this.sidPlayer.playFrame();this.framesRendered+=r;return r};v.prototype.reset=function(){this.sidPlayer.init(0);this.framesRendered=0};Cowbell.Player.JSSID=function(r){return new Cowbell.Common.WebAudioPlayer(v,r)}})();
