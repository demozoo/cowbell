window.Cowbell={UI:{},Player:{},Common:{}},window.Cowbell.createPlayer=function(a,b){b||(b={}),"string"==typeof a&&(a=document.getElementById(a));var c=b.ui||Cowbell.UI.Basic,d=new c(a);if(b.player){var e=new b.player(b.playerOpts);if(b.url){var f=new e.Track(b.url,b.trackOpts);d.open(f)}}return d},window.jQuery&&(window.jQuery.fn.cowbell=function(a){this.each(function(){Cowbell.createPlayer(this,a)})}),Cowbell.UI.Basic=function(a){function b(){g.max=100*d.duration}function c(){d=e.open(),d.readyState>=d.HAVE_METADATA?b():d.onloadedmetadata=b,d.onplay=function(){f.innerHTML="pause",f.disabled=!1,g.disabled=!1},d.onpause=function(){f.innerHTML="play"},d.ontimeupdate=function(){d&&(g.value=100*d.currentTime)},d.onended=function(){g.value=0,g.disabled=!0}}var d=null,e=null,f=document.createElement("button");f.innerHTML="play",f.disabled=!0,a.appendChild(f);var g=document.createElement("input");g.type="range",g.min=0,g.value=0,g.disabled=!0,a.appendChild(g),g.onchange=function(){d.currentTime=g.value/100},f.onclick=function(){d||c(),d.paused?(f.disabled=!0,d.play()):d.pause()},this.open=function(a){d&&!d.paused&&d.pause(),e&&e.close&&e.close(),e=a,d=null,g.value=0,g.disabled=!0,f.disabled=!1}},Cowbell.UI.Roundel=function(a){var b=Math.PI;function c(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);if(b)for(var d in b)c.setAttribute(d,b[d]);return c}function d(){n.style.display="inline"}function e(){f(0,0),n.style.display="none"}function f(a,c){angle=2*Math.min(c,.999999)*b,endX=50+48*Math.sin(angle),endY=50-48*Math.cos(angle),p.setAttribute("d","M50,50 L50,2 A48,48 0 "+(.5<=c?"1":"0")+",1 "+endX+","+endY+" Z")}function g(){t.setAttribute("fill","silver"),s.setAttribute("stroke","silver")}function h(){t.setAttribute("fill","black"),s.setAttribute("stroke","black")}function i(){k=l.open(),k.onplay=function(){t.style.display="none",u.style.display="inline",s.setAttribute("fill","white"),m.style.cursor="default",d()},k.onpause=function(){u.style.display="none",t.style.display="inline"},k.ontimeupdate=function(){k&&k.duration&&f(k.currentTime,k.currentTime/k.duration)},k.onended=function(){e(),z()}}function j(a,c){if(k&&k.duration&&k.seekable&&k.seekable.length){var d=Math.atan2(a-50,50-c),e=(d/(2*b)+1)%1,g=k.duration*e;k.currentTime=g,f(g,e)}}var k=null,l=null,m=c("svg",{width:"100",height:"100"}),n=c("g");m.appendChild(n);var o=c("circle",{cx:"50",cy:"50",r:"48",fill:"white"});n.appendChild(o);var p=c("path",{fill:"grey"});n.appendChild(p);var q=c("circle",{cx:"50",cy:"50",r:"48",stroke:"black","stroke-width":"2px",fill:"none"});n.appendChild(q);var r=c("g");m.appendChild(r);var s=c("circle",{cx:"50",cy:"50",r:"35","stroke-width":"2px",fill:"white"});r.appendChild(s);var t=c("polygon",{points:"35,30 35,70 75,50"});r.appendChild(t);var u=c("path",{d:"M35,30 L35,70 L45,70 L45,30 L35,30 M55,30 L55,70 L65,70 L65,30, L55,30",fill:"black"});u.style.display="none",r.appendChild(u),a.appendChild(m),e(),g(),r.onclick=function(){l&&(!k&&(s.setAttribute("fill","silver"),m.style.cursor="progress",i()),k.paused?k.play():k.pause())};var v,w,z=function(a){window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",z),m.style.cursor="default"},A=function(a){var b=m.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;if(50>d&&50>w){if(50>c&&50<=v)return k.currentTime=0,void(0===k.currentTime&&f(0,0));if(50<=c&&50>v)return}v=c,w=d,j(c,d)};n.onmousedown=function(a){var b=m.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;return v=c,w=d,j(c,d),window.addEventListener("mouseup",z),window.addEventListener("mousemove",A),m.style.cursor="pointer",!1},this.open=function(a){k&&!k.paused&&k.pause(),l&&l.close&&l.close(),l=a,k=null,e(),h()}},Cowbell.Player.Audio=function(){this.Track=function(a){this.open=function(){var b=document.createElement("audio");return b.src=a,document.body.appendChild(b),b}}},function(){var a;Cowbell.Common.WebAudioPlayer=function(b,c){this.Track=function(d,e){var f;this.open=function(){function g(b){m&&m.disconnect(0),0<b?f.seek(b):f.reset(),r=b,q=!1,m=a.createScriptProcessor(4096,0,f.channelCount),m.onaudioprocess=h,j.paused||(j.paused=!0,j.play())}function h(a){q||(n=a.playbackTime,q=!0);var b=f.generateAudio(a.outputBuffer);if(b<a.outputBuffer.length){for(var c,d=0;d<a.outputBuffer.numberOfChannels;d++){c=a.outputBuffer.getChannelData(d);for(var e=b;e<a.outputBuffer.length;e++)c[e]=0}j.currentTime>j.duration&&(j.pause(),j.onended&&j.onended(),g(0))}j.ontimeupdate&&j.ontimeupdate()}var j={};if(!a){var k=window.AudioContext||window.webkitAudioContext;a=new k}"suspended"===a.state&&a.resume();var l=4096;j.HAVE_NOTHING=0,j.HAVE_METADATA=1,j.HAVE_CURRENT_DATA=2,j.HAVE_FUTURE_DATA=3,j.HAVE_ENOUGH_DATA=4,j.readyState=j.HAVE_NOTHING,f=new b(d,a,c,e);var m,n,o=!1,p=!1,q=!1,r=0;return j.paused=!0,f.load(function(){o=!0,j.readyState=j.HAVE_ENOUGH_DATA,j.duration=f.duration,j.seekable=f.seekable?{length:1,start:function(a){if(0!==a)throw"Out of range";return 0},end:function(a){if(0!==a)throw"Out of range";return f.duration}}:{length:0,start:function(a){throw"Out of range"},end:function(a){throw"Out of range"}},g(0),j.onloadedmetadata&&j.onloadedmetadata(),p&&j.play()}),j.play=function(){return o?void(j.paused&&(m.connect(a.destination),j.paused=!1,j.onplay&&j.onplay(),q&&(n=a.currentTime,r=pausedAtTrackTime))):void(p=!0)},j.pause=function(){j.paused||(pausedAtTimestamp=a.currentTime,pausedAtTrackTime=j.currentTime,m.disconnect(0),j.paused=!0,j.onpause&&j.onpause())},j.__defineGetter__("currentTime",function(){return q?j.paused?pausedAtTrackTime:a.currentTime<n?r:r+a.currentTime-n:r}),j.__defineSetter__("currentTime",function(a){(f.seekable||0===a)&&g(a)}),j},this.close=function(){f&&f.cleanup&&f.cleanup()}}}}();