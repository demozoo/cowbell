window.Cowbell={UI:{},Player:{},Common:{}};window.Cowbell.createPlayer=function(e,c){c||(c={});"string"==typeof e&&(e=document.getElementById(e));var l=new (c.ui||Cowbell.UI.Basic)(e);if(c.player){var d=new c.player(c.playerOpts);c.url&&(d=new d.Track(c.url,c.trackOpts),l.open(d))}return l};window.jQuery&&(window.jQuery.fn.cowbell=function(e){this.each(function(){Cowbell.createPlayer(this,e)})});Cowbell.UI.Basic=function(e){function c(){a.max=100*d.duration}function l(){d=n.open();d.readyState>=d.HAVE_METADATA?c():d.onloadedmetadata=c;d.onplay=function(){f.innerHTML="pause";f.disabled=!1;a.disabled=!1};d.onpause=function(){f.innerHTML="play"};d.ontimeupdate=function(){d&&(a.value=100*d.currentTime)};d.onended=function(){a.value=0;a.disabled=!0}}var d=null,n=null,f=document.createElement("button");f.innerHTML="play";f.disabled=!0;e.appendChild(f);var a=document.createElement("input");a.type=
"range";a.min=0;a.value=0;a.disabled=!0;e.appendChild(a);a.onchange=function(){d.currentTime=a.value/100};f.onclick=function(){d||l();d.paused?(f.disabled=!0,d.play()):d.pause()};this.open=function(c){d&&!d.paused&&d.pause();n&&n.close&&n.close();n=c;d=null;a.value=0;a.disabled=!0;f.disabled=!1}};Cowbell.UI.Roundel=function(e){function c(b,a){var d=document.createElementNS("http://www.w3.org/2000/svg",b);if(a)for(var c in a)d.setAttribute(c,a[c]);return d}function l(){d(0,0);p.style.display="none"}function d(b,a){angle=2*Math.min(a,0.999999)*Math.PI;endX=50+48*Math.sin(angle);endY=50-48*Math.cos(angle);s.setAttribute("d","M50,50 L50,2 A48,48 0 "+(0.5<=a?"1":"0")+",1 "+endX+","+endY+" Z")}function n(){a=r.open();a.onplay=function(){k.style.display="none";m.style.display="inline";g.setAttribute("fill",
"white");b.style.cursor="default";p.style.display="inline"};a.onpause=function(){m.style.display="none";k.style.display="inline"};a.ontimeupdate=function(){a&&a.duration&&d(a.currentTime,a.currentTime/a.duration)};a.onended=function(){l();t()}}function f(b,c){if(a&&a.duration&&a.seekable&&a.seekable.length){var f=(Math.atan2(b-50,50-c)/(2*Math.PI)+1)%1,e=a.duration*f;a.currentTime=e;d(e,f)}}var a=null,r=null,b=c("svg",{width:"100",height:"100"}),p=c("g");b.appendChild(p);var h=c("circle",{cx:"50",
cy:"50",r:"48",fill:"white"});p.appendChild(h);var s=c("path",{fill:"grey"});p.appendChild(s);h=c("circle",{cx:"50",cy:"50",r:"48",stroke:"black","stroke-width":"2px",fill:"none"});p.appendChild(h);h=c("g");b.appendChild(h);var g=c("circle",{cx:"50",cy:"50",r:"35","stroke-width":"2px",fill:"white"});h.appendChild(g);var k=c("polygon",{points:"35,30 35,70 75,50"});h.appendChild(k);var m=c("path",{d:"M35,30 L35,70 L45,70 L45,30 L35,30 M55,30 L55,70 L65,70 L65,30, L55,30",fill:"black"});m.style.display=
"none";h.appendChild(m);e.appendChild(b);l();k.setAttribute("fill","silver");g.setAttribute("stroke","silver");h.onclick=function(){r&&(a||(g.setAttribute("fill","silver"),b.style.cursor="progress",n()),a.paused?a.play():a.pause())};var q,u,t=function(a){window.removeEventListener("mousemove",v);window.removeEventListener("mouseup",t);b.style.cursor="default"},v=function(c){var e=b.getBoundingClientRect(),g=c.clientX-e.left;c=c.clientY-e.top;if(50>c&&50>u){if(50>g&&50<=q){a.currentTime=0;0===a.currentTime&&
d(0,0);return}if(50<=g&&50>q)return}q=g;u=c;f(g,c)};p.onmousedown=function(a){var c=b.getBoundingClientRect(),d=a.clientX-c.left;a=a.clientY-c.top;q=d;u=a;f(d,a);window.addEventListener("mouseup",t);window.addEventListener("mousemove",v);b.style.cursor="pointer";return!1};this.open=function(b){a&&!a.paused&&a.pause();r&&r.close&&r.close();r=b;a=null;l();k.setAttribute("fill","black");g.setAttribute("stroke","black")}};Cowbell.Player.Audio=function(){this.Track=function(e){this.open=function(){var c=document.createElement("audio");c.src=e;document.body.appendChild(c);return c}}};(function(){var e;Cowbell.Common.WebAudioPlayer=function(c,l){this.Track=function(d,n){var f;this.open=function(){function a(a){g&&g.disconnect(0);0<a?f.seek(a):f.reset();m=a;k=!1;g=e.createScriptProcessor(p,0,f.channelCount);g.onaudioprocess=r;b.paused||(b.paused=!0,b.play())}function r(c){k||(q=c.playbackTime,k=!0);var d=f.generateAudio(c.outputBuffer);if(d<c.outputBuffer.length){for(var e=0;e<c.outputBuffer.numberOfChannels;e++)for(var g=c.outputBuffer.getChannelData(e),h=d;h<c.outputBuffer.length;h++)g[h]=
0;if(b.currentTime>b.duration){b.pause();if(b.onended)b.onended();a(0)}}if(b.ontimeupdate)b.ontimeupdate()}var b={};e||(e=new (window.AudioContext||window.webkitAudioContext));var p=4096;b.HAVE_NOTHING=0;b.HAVE_METADATA=1;b.HAVE_CURRENT_DATA=2;b.HAVE_FUTURE_DATA=3;b.HAVE_ENOUGH_DATA=4;b.readyState=b.HAVE_NOTHING;f=new c(d,e,l,n);var h=!1,s=!1,g,k=!1,m=0,q;b.paused=!0;f.load(function(){h=!0;b.readyState=b.HAVE_ENOUGH_DATA;b.duration=f.duration;b.seekable=f.seekable?{length:1,start:function(a){if(0!==
a)throw"Out of range";return 0},end:function(a){if(0!==a)throw"Out of range";return f.duration}}:{length:0,start:function(a){throw"Out of range";},end:function(a){throw"Out of range";}};a(0);if(b.onloadedmetadata)b.onloadedmetadata();s&&b.play()});b.play=function(){if(h){if(b.paused){g.connect(e.destination);b.paused=!1;if(b.onplay)b.onplay();k&&(q=e.currentTime,m=pausedAtTrackTime)}}else s=!0};b.pause=function(){if(!b.paused&&(pausedAtTimestamp=e.currentTime,pausedAtTrackTime=b.currentTime,g.disconnect(0),
b.paused=!0,b.onpause))b.onpause()};b.__defineGetter__("currentTime",function(){return!k?m:b.paused?pausedAtTrackTime:e.currentTime<q?m:m+e.currentTime-q});b.__defineSetter__("currentTime",function(b){(f.seekable||0===b)&&a(b)});return b};this.close=function(){f&&f.cleanup&&f.cleanup()}}}})();
