(function(){function p(l,p,e,n){function r(a){function c(a){var b=stackAlloc(a.length+1);writeAsciiToMemory(a,b);return b}a=new Int8Array(a);var b=libopenmpt._malloc(a.byteLength);libopenmpt.HEAPU8.set(a,b);d=libopenmpt._openmpt_module_create_from_memory(b,a.byteLength,0,0,0);f=libopenmpt._malloc(4*q);g=libopenmpt._malloc(4*q);a=stackSave();libopenmpt._openmpt_module_ctl_set(d,c("render.resampler.emulate_amiga"),c("1"));libopenmpt._openmpt_module_ctl_set(d,c("render.resampler.emulate_amiga_type"),
c("a1200"));stackRestore(a);s.duration=libopenmpt._openmpt_module_get_duration_seconds(d)}function t(a){if(!e.pathToLibOpenMPT)throw"pathToLibOpenMPT not specified";if(window.libopenmpt&&window.libopenmpt._openmpt_module_create_from_memory)a();else{var c=document.getElementsByTagName("head")[0],b=document.createElement("script");b.src=e.pathToLibOpenMPT;window.libopenmpt={onRuntimeInitialized:function(){a();c.removeChild(b)}};c.appendChild(b)}}var d,f,g,q=4096,s=this;e||(e={});n||(n={});this.cleanup=
function(){d&&libopenmpt._openmpt_module_destroy(d);f&&libopenmpt._free(f);g&&libopenmpt._free(g)};this.load=function(a){var c=this;t(function(){c.channelCount=2;var b=new XMLHttpRequest;b.addEventListener("error",function(a){console.log("XHR error",a)});b.addEventListener("load",function(c){data=b.response;r(data);a()});b.open("GET",l,!0);b.responseType="arraybuffer";b.send()})};this.generateAudio=function(a){var c=a.getChannelData(0),b=a.getChannelData(1);a=a.length;for(var m=0;0<a;){for(var e=
Math.min(a,q),h=libopenmpt._openmpt_module_read_float_stereo(d,p.sampleRate,e,f,g),l=libopenmpt.HEAPF32.subarray(f/4,f/4+h),n=libopenmpt.HEAPF32.subarray(g/4,g/4+h),k=0;k<h;++k)c[m+k]=l[k],b[m+k]=n[k];a-=h;m+=h;if(h<e)break}return m};this.seekable=!0;this.seek=function(a){libopenmpt._openmpt_module_set_position_seconds(d,a)};this.reset=function(){this.seek(0)}}Cowbell.Player.OpenMPT=function(l){return new Cowbell.Common.WebAudioPlayer(p,l)}})();
