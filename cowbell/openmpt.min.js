(function(){function n(f,n,c,m){function p(a){if(!c.pathToLibOpenMPT)throw"pathToLibOpenMPT not specified";if(window.libopenmpt&&window.libopenmpt._openmpt_module_create_from_memory)a();else{var e=document.getElementsByTagName("head")[0],b=document.createElement("script");b.src=c.pathToLibOpenMPT;window.libopenmpt={onRuntimeInitialized:function(){a();e.removeChild(b)}};e.appendChild(b)}}var e,g,h,q=this;c||(c={});m||(m={});this.cleanup=function(){e&&libopenmpt._openmpt_module_destroy(e);g&&libopenmpt._free(g);
h&&libopenmpt._free(h)};this.load=function(a){var c=this;p(function(){c.channelCount=2;var b=new XMLHttpRequest;b.addEventListener("error",function(a){console.log("XHR error",a)});b.addEventListener("load",function(d){data=b.response;d=new Int8Array(data);var c=libopenmpt._malloc(d.byteLength);libopenmpt.HEAPU8.set(d,c);e=libopenmpt._openmpt_module_create_from_memory(c,d.byteLength,0,0,0);g=libopenmpt._malloc(16384);h=libopenmpt._malloc(16384);q.duration=libopenmpt._openmpt_module_get_duration_seconds(e);
a()});b.open("GET",f,!0);b.responseType="arraybuffer";b.send()})};this.generateAudio=function(a){var c=a.getChannelData(0),b=a.getChannelData(1);a=a.length;for(var d=0;0<a;){for(var f=Math.min(a,4096),k=libopenmpt._openmpt_module_read_float_stereo(e,n.sampleRate,f,g,h),m=libopenmpt.HEAPF32.subarray(g/4,g/4+k),p=libopenmpt.HEAPF32.subarray(h/4,h/4+k),l=0;l<k;++l)c[d+l]=m[l],b[d+l]=p[l];a-=k;d+=k;if(k<f)break}return d};this.seekable=!0;this.seek=function(a){libopenmpt._openmpt_module_set_position_seconds(e,
a)};this.reset=function(){this.seek(0)}}Cowbell.Player.OpenMPT=function(f){return new Cowbell.Common.WebAudioPlayer(n,f)}})();
