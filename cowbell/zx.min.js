(function(){window.Cowbell.Common.buildZ80=function(r){var e,a,s,t,g,n,f,o,l,P,d,v,p,u,E,c,m,M,A,b,D,h,x,y,L,H,R,C,T,B,I,k,w,F,z,W,S,Y,q,X,_,U,O,Z,j,Q,G,$,N,J,K,V,rr,er,ar,sr,ir,tr,gr,nr,fr,or,lr,Pr,dr,vr,pr,ur,Er,cr,mr,Mr,Ar,br,Dr,hr,xr,yr,Lr,Hr,Rr,Cr,Tr,Br,Ir,kr,wr,Fr,zr,Wr,Sr,Yr,qr,Xr,_r,Ur,Or,Zr,jr,Qr,Gr,$r,Nr,Jr,Kr,Vr,re,ee,ae,se,ie,te,ge,ne,fe,oe,le,Pe,de,ve,pe,ue,Ee,ce,me,Me,Ae,be,De,he,xe,ye,Le,He,Re,Ce,Te,Be,Ie,ke,we,Fe,ze,We,Se,Ye,qe,Xe,_e,Ue,Oe,Ze,je,Qe,Ge,$e,Ne,Je,Ke,Ve,ra,ea,aa,sa,ia,ta,ga,na,fa,oa,la,Pa;return null==r&&(r={}),Me=new ArrayBuffer(2),Ae=new Uint16Array(Me),be=new Uint8Array(Me),Ae[0]=256,Le=1===be[0],Ke=0,ra=1,aa=2,ia=3,Ve=4,ea=5,sa=6,ta=7,na=8,fa=9,ga=10,la=11,oa=12,Je={IX:8,IY:9},Le?(Re=0,Se=1,Te=2,Ie=3,we=4,ze=5,qe=6,Qe=7,Ce=8,Ye=9,Be=10,ke=11,Fe=12,We=13,Xe=14,Ge=15,Ue=16,Oe=17,Ze=18,je=19,_e=20,$e=21,Ne={A:0,F:1,B:2,C:3,D:4,E:5,H:6,L:7,IXH:16,IXL:17,IYH:18,IYL:19}):(Se=0,Re=1,Ie=2,Te=3,ze=4,we=5,Qe=6,qe=7,Ye=8,Ce=9,ke=10,Be=11,We=12,Fe=13,Ge=14,Xe=15,Oe=16,Ue=17,je=18,Ze=19,$e=20,_e=21,Ne={F:0,A:1,C:2,B:3,E:4,D:5,L:6,H:7,IXL:16,IXH:17,IYL:18,IYH:19}),I=1,w=2,F=4,W=4,T=8,k=16,B=32,S=64,z=128,Pa="var memory = opts.memory;\nvar ioBus = opts.ioBus;\n\nvar registerBuffer = new ArrayBuffer(26);\n/* Expose registerBuffer as both register pairs and individual registers */\nvar regPairs = new Uint16Array(registerBuffer);\nvar regs = new Uint8Array(registerBuffer);\n\nvar iff1 = 0;\nvar iff2 = 0;\nvar im = 0;\nvar halted = false;\n\n/* tables for setting Z80 flags */\n\n/*\n\tWhether a half carry occurred or not can be determined by looking at\n\tthe 3rd bit of the two arguments and the result; these are hashed\n\tinto this table in the form r12, where r is the 3rd bit of the\n\tresult, 1 is the 3rd bit of the 1st argument and 2 is the\n\tthird bit of the 2nd argument; the tables differ for add and subtract\n\toperations\n*/\nvar halfcarryAddTable = new Uint8Array([0, "+k+", "+k+", "+k+", 0, 0, 0, "+k+"]);\nvar halfcarrySubTable = new Uint8Array([0, 0, "+k+", 0, "+k+", 0, "+k+", "+k+"]);\n\n/*\n\tSimilarly, overflow can be determined by looking at the 7th bits; again\n\tthe hash into this table is r12\n*/\nvar overflowAddTable = new Uint8Array([0, 0, 0, "+W+", "+W+", 0, 0, 0]);\nvar overflowSubTable = new Uint8Array([0, "+W+", 0, 0, 0, 0, "+W+", 0]);\n\nvar sz53Table = new Uint8Array(0x100); /* The S, Z, 5 and 3 bits of the index */\nvar parityTable = new Uint8Array(0x100); /* The parity of the lookup value */\nvar sz53pTable = new Uint8Array(0x100); /* OR the above two tables together */\n\nfor (var i = 0; i < 0x100; i++) {\n\tsz53Table[i] = i & ( "+(T|B|z)+" );\n\tvar j = i;\n\tvar parity = 0;\n\tfor (var k = 0; k < 8; k++) {\n\t\tparity ^= j & 1;\n\t\tj >>=1;\n\t}\n\n\tparityTable[i] = (parity ? 0 : "+F+");\n\tsz53pTable[i] = sz53Table[i] | parityTable[i];\n\t\n\tsz53Table[0] |= "+S+";\n\tsz53pTable[0] |= "+S+";\n}\n\nvar interruptible = true;\nvar interruptPending = false;\nvar opcodePrefix = '';",xe=function(r,e){var a,s,t,g;if(null==e&&(e=!1),r.match(/^[AFBCDEHL]|I[XY][HL]$/))return t=Ne[r],{getter:"",v:"regs["+t+"]",trunc:"",setter:""};if("(HL)"===r)return{getter:"var val = READMEM(regPairs["+ia+"]);",v:"val",trunc:"& 0xff",setter:"WRITEMEM(regPairs["+ia+"], val);"};if("nn"===r)return{getter:"var val = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;",v:"val",trunc:"& 0xff",setter:""};if(s=r.match(/^\((I[XY])\+nn\)$/))return g=Je[s[1]],a=e?"":"var offset = READMEM(regPairs["+oa+"]);\nif (offset & 0x80) offset -= 0x100;\nregPairs["+oa+"]++;",a+="var addr = (regPairs["+g+"] + offset) & 0xffff;\nvar val = READMEM(addr);",{getter:a,v:"val",trunc:"& 0xff",setter:"WRITEMEM(addr, val);"};if("add"===r)return{getter:"",v:"add",trunc:"",setter:""};throw"Unknown param format: "+r},e=function(r){var e;return e=xe(r),e.getter+"\n\nvar adctemp = regs["+Re+"] + "+e.v+" + (regs["+Se+"] & "+I+");\nvar lookup = ( (regs["+Re+"] & 0x88) >> 3 ) | ( ("+e.v+" & 0x88) >> 2 ) | ( (adctemp & 0x88) >> 1 );\nregs["+Re+"] = adctemp;\nregs["+Se+"] = ( adctemp & 0x100 ? "+I+" : 0 ) | halfcarryAddTable[lookup & 0x07] | overflowAddTable[lookup >> 4] | sz53Table[regs["+Re+"]];"},a=function(r){return"var add16temp = regPairs["+ia+"] + regPairs["+r+"] + (regs["+Se+"] & "+I+");\nvar lookup = (\n\t( (regPairs["+ia+"] & 0x8800) >> 11 ) |\n\t( (regPairs["+r+"] & 0x8800) >> 10 ) |\n\t( (add16temp & 0x8800) >>  9 )\n);\nregPairs["+ia+"] = add16temp;\nregs["+Se+"] = (\n\t(add16temp & 0x10000 ? "+I+" : 0) |\n\toverflowAddTable[lookup >> 4] |\n\t(regs["+qe+"] & "+(T|B|z)+") |\n\thalfcarryAddTable[lookup & 0x07] |\n\t(regPairs["+ia+"] ? 0 : "+S+")\n);"},s=function(r){var e;return e=xe(r),e.getter+"\n\nvar addtemp = regs["+Re+"] + "+e.v+";\nvar lookup = ( (regs["+Re+"] & 0x88) >> 3 ) | ( ("+e.v+" & 0x88) >> 2 ) | ( (addtemp & 0x88) >> 1 );\nregs["+Re+"] = addtemp;\nregs["+Se+"] = ( addtemp & 0x100 ? "+I+" : 0 ) | halfcarryAddTable[lookup & 0x07] | overflowAddTable[lookup >> 4] | sz53Table[regs["+Re+"]];"},t=function(r,e){return"var add16temp = regPairs["+r+"] + regPairs["+e+"];\nvar lookup = ( (regPairs["+r+"] & 0x0800) >> 11 ) | ( (regPairs["+e+"] & 0x0800) >> 10 ) | ( (add16temp & 0x0800) >>  9 );\nregPairs["+r+"] = add16temp;\nregs["+Se+"] = ( regs["+Se+"] & ( "+(W|S|z)+" ) ) | ( add16temp & 0x10000 ? "+I+" : 0 ) | ( ( add16temp >> 8 ) & ( "+(T|B)+" ) ) | halfcarryAddTable[lookup];"},g=function(r){var e;return e=xe(r),e.getter+"\n\nregs["+Re+"] &= "+e.v+";\nregs["+Se+"] = "+k+" | sz53pTable[regs["+Re+"]];"},o=function(r,e){var a;return a=7===r?"if (value & 0x80) regs["+Se+"] |= "+z+";":"","var addr = (regPairs["+e+"] + offset) & 0xffff;\nvar value = READMEM(addr);\nregs["+Se+"] = ( regs["+Se+"] & "+I+" ) | "+k+" | ( ( addr >> 8 ) & "+(T|B)+" );\nif ( !(value & "+(1<<r)+") ) regs["+Se+"] |= "+(F|S)+";\n"+a},f=function(r){var e;return e=7===r?"if (value & 0x80) regs["+Se+"] |= "+z+";":"","var addr = regPairs["+ia+"];\nvar value = READMEM(addr);\nregs["+Se+"] = ( regs["+Se+"] & "+I+" ) | "+k+" | ( value & "+(T|B)+" );\nif( !(value & "+(1<<r)+") ) regs["+Se+"] |= "+(F|S)+";\n"+e},n=function(e,a){var r;return r=7===e?"if (regs["+a+"] & 0x80) regs["+Se+"] |= "+z+";":"","regs["+Se+"] = ( regs["+Se+"] & "+I+" ) | "+k+" | ( regs["+a+"] & "+(T|B)+" );\nif( !(regs["+a+"] & "+(1<<e)+") ) regs["+Se+"] |= "+(F|S)+";\n"+r},l=function(r,e){var a;return a="regs["+Se+"] & "+r,e||(a="!("+a+")"),"if ("+a+") {\n\tvar l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\n\tvar h = READMEM(regPairs["+oa+"]);\n\tregPairs["+oa+"]++;\n\tregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] >> 8);\n\tregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] & 0xff);\n\tregPairs["+oa+"] = (h<<8) | l;\n} else {\n\tregPairs["+oa+"]++;\n\tregPairs["+oa+"]++;\n}"},P=function(){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]);\nregPairs["+oa+"]++;\nregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] >> 8);\nregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] & 0xff);\nregPairs["+oa+"] = (h<<8) | l;"},d=function(){return"regs["+Se+"] = ( regs["+Se+"] & "+(F|S|z)+" ) | ( (regs["+Se+"] & "+I+") ? "+k+" : "+I+" ) | ( regs["+Re+"] & "+(T|B)+" );"},A=function(r){var e;return e=xe(r),e.getter+"\n\nvar cptemp = regs["+Re+"] - "+e.v+";\nvar lookup = ( (regs["+Re+"] & 0x88) >> 3 ) | ( ("+e.v+" & 0x88) >> 2 ) | ( (cptemp & 0x88) >> 1 );\nregs["+Se+"] = ( cptemp & 0x100 ? "+I+" : ( cptemp ? 0 : "+S+" ) ) | "+w+" | halfcarrySubTable[lookup & 0x07] | overflowSubTable[lookup >> 4] | ( "+e.v+" & "+(T|B)+" ) | ( cptemp & "+z+" );"},m=function(r){return"var value = READMEM(regPairs["+ia+"]);\nvar bytetemp = (regs["+Re+"] - value) & 0xff;\nvar lookup = ((regs["+Re+"] & 0x08) >> 3) | ((value & 0x08) >> 2) | ((bytetemp & 0x08) >> 1);\nvar originalHL = regPairs["+ia+"];\nregPairs["+ia+"]"+r+"; regPairs["+ra+"]--;\nregs["+Se+"] = (regs["+Se+"] & "+I+") | (regPairs["+ra+"] ? "+(W|w)+" : "+w+") | halfcarrySubTable[lookup] | (bytetemp ? 0 : "+S+") | (bytetemp & "+z+");\nif (regs["+Se+"] & "+k+") bytetemp--;\nregs["+Se+"] |= (bytetemp & "+T+") | ( (bytetemp & 0x02) ? "+B+" : 0 );"},c=function(r){return m(r)+"\nif ((regs["+Se+"] & "+(W|S)+") == "+W+") {\n\tregPairs["+oa+"] -= 2;\n}"},v=function(){return m("--")},u=function(){return m("++")},p=function(){return c("--")},E=function(){return c("++")},b=function(){var r,e;return e=Ee("add"),r=s("add"),"var add = 0;\nvar carry = regs["+Se+"] & "+I+";\nif( ( regs["+Se+"] & "+k+" ) || ( ( regs["+Re+"] & 0x0f ) > 9 ) ) add = 6;\nif( carry || ( regs["+Re+"] > 0x99 ) ) add |= 0x60;\nif( regs["+Re+"] > 0x99 ) carry = "+I+";\nif( regs["+Se+"] & "+w+" ) {\n\t"+e+"\n} else {\n\t"+r+"\n}\nregs["+Se+"] = ( regs["+Se+"] & "+~(I|F)+" ) | carry | parityTable[regs["+Re+"]];"},M=function(){return"regs["+Re+"] ^= 0xff;\nregs["+Se+"] = (regs["+Se+"] & "+(I|F|S|z)+") | (regs["+Re+"] & "+(T|B)+") | "+(w|k)+";"},D=function(r){var e;return e=xe(r),e.getter+"\n\nregs["+Se+"] = (regs["+Se+"] & "+I+" ) | ( "+e.v+" & 0x0f ? 0 : "+k+" ) | "+w+";\n"+e.v+" = ("+e.v+" - 1) "+e.trunc+";\n\n"+e.setter+"\nregs["+Se+"] |= ("+e.v+" == 0x7f ? "+W+" : 0) | sz53Table["+e.v+"];"},h=function(r){return"regPairs["+r+"]--;"},x=function(){return"iff1 = iff2 = 0;"},y=function(){return"regs["+Te+"]--;\nif (regs["+Te+"]) {\n\t/* take branch */\n\tvar offset = READMEM(regPairs["+oa+"]);\n\tregPairs["+oa+"]++;\n\tregPairs["+oa+"] += (offset & 0x80 ? offset - 0x100 : offset);\n} else {\n\t/* do not take branch */\n\tregPairs["+oa+"]++;\n}"},L=function(){return"iff1 = iff2 = 1;\ninterruptible = false;"},C=function(r){return"var l = READMEM(regPairs["+la+"]);\nvar spPlus1 = (regPairs["+la+"] + 1) & 0xffff;\nvar h = READMEM(spPlus1);\nWRITEMEM(spPlus1, regPairs["+r+"] >> 8);\nWRITEMEM(regPairs["+la+"], regPairs["+r+"] & 0xff);\nregPairs["+r+"] = (h<<8) | l;"},R=function(r,e){return"var temp = regPairs["+r+"];\nregPairs["+r+"] = regPairs["+e+"];\nregPairs["+e+"] = temp;"},H=function(){return"var wordtemp;\nwordtemp = regPairs["+ra+"]; regPairs["+ra+"] = regPairs["+ea+"]; regPairs["+ea+"] = wordtemp;\nwordtemp = regPairs["+aa+"]; regPairs["+aa+"] = regPairs["+sa+"]; regPairs["+sa+"] = wordtemp;\nwordtemp = regPairs["+ia+"]; regPairs["+ia+"] = regPairs["+ta+"]; regPairs["+ta+"] = wordtemp;"},Y=function(){return"halted = true;\nregPairs["+oa+"]--;"},q=function(r){return"im = "+r+";"},$=function(){return"var val = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar port = (regs["+Re+"] << 8) | val;\nregs["+Re+"] = ioBus.read(port);"},N=function(){return"var port = regPairs["+ra+"];\nvar result = ioBus.read(port);\nregs["+Se+"] = (regs["+Se+"] & "+I+") | sz53pTable[result];"},J=function(e){return"var port = regPairs["+ra+"];\nregs["+e+"] = ioBus.read(port);\nregs["+Se+"] = (regs["+Se+"] & "+I+") | sz53pTable[regs["+e+"]];"},X=function(r){var e;return e=xe(r),e.getter+"\n\nregs["+Se+"] = (regs["+Se+"] & "+I+") | ("+e.v+" & 0x0f ? 0 : "+k+") | "+w+";\n"+e.v+" = ("+e.v+" + 1) "+e.trunc+";\n\n"+e.setter+"\nregs["+Se+"] = (regs["+Se+"] & "+I+") | ( "+e.v+" == 0x80 ? "+W+" : 0 ) | ( "+e.v+" & 0x0f ? 0 : "+k+" ) | sz53Table["+e.v+"];"},_=function(r){return"regPairs["+r+"]++;"},G=function(r){return"var initemp = ioBus.read(regPairs["+ra+"]);\nWRITEMEM(regPairs["+ia+"], initemp);\nregs["+Te+"]--;\nvar originalHL = regPairs["+ia+"];\nregPairs["+ia+"]"+r+r+";\nvar initemp2 = (initemp + regs["+Ie+"] "+r+" 1) & 0xff;\n\nregs["+Se+"] = (initemp & 0x80 ? "+w+" : 0) | ((initemp2 < initemp) ? "+(k|I)+" : 0 ) | ( parityTable[ (initemp2 & 0x07) ^ regs["+Te+"] ] ? "+F+" : 0 ) | sz53Table[regs["+Te+"]];"},Q=function(r){return G(r)+"\nif (regs["+Te+"]) {\n\tregPairs["+oa+"] -= 2;\n}"},Z=function(){return G("+")},U=function(){return G("-")},j=function(){return Q("+")},O=function(){return Q("-")},K=function(r,e){var a;return a="regs["+Se+"] & "+r,e||(a="!("+a+")"),"if ("+a+") {\n\tvar l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\n\tvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\n\tregPairs["+oa+"] = (h<<8) | l;\n} else {\n\tregPairs["+oa+"]++;\n\tregPairs["+oa+"]++;\n}"},rr=function(r){return"regPairs["+oa+"] = regPairs["+r+"];"},V=function(){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nregPairs["+oa+"] = (h<<8) | l;"},er=function(r,e){var a;return a="regs["+Se+"] & "+r,e||(a="!("+a+")"),"if ("+a+") {\n\tvar offset = READMEM(regPairs["+oa+"]);\n\tregPairs["+oa+"]++;\n\tregPairs["+oa+"] += (offset & 0x80 ? offset - 0x100 : offset);\n} else {\n\tregPairs["+oa+"]++; /* skip past offset byte */\n}"},ar=function(){return"var offset = READMEM(regPairs["+oa+"]);\nregPairs["+oa+"]++;\nregPairs["+oa+"] += (offset & 0x80 ? offset - 0x100 : offset);"},Pr=function(){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar addr = (h<<8) | l;\nregs["+Re+"] = READMEM(addr);"},Mr=function(){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar addr = (h<<8) | l;\nWRITEMEM(addr, regs["+Re+"]);"},Ar=function(r){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar addr = (h<<8) | l;\nWRITEMEM(addr, regPairs["+r+"] & 0xff);\naddr = (addr + 1) & 0xffff;\nWRITEMEM(addr, regPairs["+r+"] >> 8);"},br=function(r){return"var n = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nWRITEMEM(regPairs["+r+"], n);"},Dr=function(e,a){return"WRITEMEM(regPairs["+e+"], regs["+a+"]);"},hr=function(r){return"var offset = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nif (offset & 0x80) offset -= 0x100;\nvar addr = (regPairs["+r+"] + offset) & 0xffff;\n\nvar val = READMEM(regPairs["+oa+"]);\nregPairs["+oa+"]++;\nWRITEMEM(addr, val);"},xr=function(e,a){return"var offset = READMEM(regPairs["+oa+"]);\nregPairs["+oa+"]++;\nif (offset & 0x80) offset -= 0x100;\nvar addr = (regPairs["+e+"] + offset) & 0xffff;\n\nWRITEMEM(addr, regs["+a+"]);"},cr=function(e,r){return"regs["+e+"] = READMEM(regPairs["+r+"]);"},mr=function(e,r){return"var offset = READMEM(regPairs["+oa+"]);\nregPairs["+oa+"]++;\nif (offset & 0x80) offset -= 0x100;\nvar addr = (regPairs["+r+"] + offset) & 0xffff;\n\nregs["+e+"] = READMEM(addr);"},ur=function(e){return"regs["+e+"] = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;"},Er=function(r,e){var a;return r===_e||e===_e||r===$e||e===$e?(a="regs["+r+"] = regs["+e+"];",r===Re&&(a+="regs["+Se+"] = (regs["+Se+"] & "+I+") | sz53Table[regs["+Re+"]] | ( iff2 ? "+W+" : 0 );"),a):"regs["+r+"] = regs["+e+"];"},pr=function(r){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar addr = (h<<8) | l;\nl = READMEM(addr);\naddr = (addr + 1) & 0xffff;\nh = READMEM(addr);\nregPairs["+r+"] = (h<<8) | l;"},dr=function(r){return"var l = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nvar h = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nregPairs["+r+"] = (h<<8) | l;"},vr=function(r,e){return"regPairs["+r+"] = regPairs["+e+"];"},sr=function(r,e,a,s){var t;return t=Ne[r],"var addr = (regPairs["+s+"] + offset) & 0xffff;\nregs["+t+"] = READMEM(addr);\n"+e(a,r)+"\nWRITEMEM(addr, regs["+t+"]);"},or=function(r){return"var bytetemp = READMEM(regPairs["+ia+"]);\nregPairs["+ra+"]--;\nWRITEMEM(regPairs["+aa+"],bytetemp);\nvar originalDE = regPairs["+aa+"];\nregPairs["+aa+"]"+r+"; regPairs["+ia+"]"+r+";\nbytetemp = (bytetemp + regs["+Re+"]) & 0xff;\nregs["+Se+"] = (regs["+Se+"] & "+(I|S|z)+") | (regPairs["+ra+"] ? "+W+" : 0) | (bytetemp & "+T+") | ((bytetemp & 0x02) ? "+B+" : 0);"},fr=function(r){return or(r)+"\nif (regPairs["+ra+"]) {\n\tregPairs["+oa+"]-=2;\n}"},gr=function(){return or("++")},ir=function(){return or("--")},nr=function(){return fr("++")},tr=function(){return fr("--")},lr=function(r,e,a){var s;return s=Ne[r],"var addr = (regPairs["+a+"] + offset) & 0xffff;\nregs["+s+"] = READMEM(addr);\n"+e(r)+"\nWRITEMEM(addr, regs["+s+"]);"},yr=function(){return"var val = regs["+Re+"];\nvar subtemp = -val;\nvar lookup = ( (val & 0x88) >> 2 ) | ( (subtemp & 0x88) >> 1 );\nregs["+Re+"] = subtemp;\nregs["+Se+"] = ( subtemp & 0x100 ? "+I+" : 0 ) | "+w+" | halfcarrySubTable[lookup & 0x07] | overflowSubTable[lookup >> 4] | sz53Table[regs["+Re+"]];"},Lr=function(){return"\t\t"},wr=function(r){var e;return e=xe(r),e.getter+"\n\nregs["+Re+"] |= "+e.v+";\nregs["+Se+"] = sz53pTable[regs["+Re+"]];"},Xr=function(){return"ioBus.write(regPairs["+ra+"], 0);"},_r=function(e){return"ioBus.write(regPairs["+ra+"], regs["+e+"]);"},Ur=function(){return"var port = (regs["+Re+"] << 8) | READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\nioBus.write(port, regs["+Re+"]);"},qr=function(r){return"var outitemp = READMEM(regPairs["+ia+"]);\nregs["+Te+"]--;\t/* This does happen first, despite what the specs say */\nioBus.write(regPairs["+ra+"], outitemp);\n\nregPairs["+ia+"]"+r+";\noutitemp2 = (outitemp + regs["+Qe+"]) & 0xff;\nregs["+Se+"] = (outitemp & 0x80 ? "+w+" : 0) | ( (outitemp2 < outitemp) ? "+(k|I)+" : 0) | (parityTable[ (outitemp2 & 0x07) ^ regs["+Te+"] ] ? "+F+" : 0 ) | sz53Table[ regs["+Te+"] ];"},Wr=function(r){return qr(r)+"\nif (regs["+Te+"]) {\n\tregPairs["+oa+"]-=2;\n}"},Sr=function(){return qr("--")},Yr=function(){return qr("++")},Fr=function(){return Wr("--")},zr=function(){return Wr("++")},Or=function(r){return"var l = READMEM(regPairs["+la+"]); regPairs["+la+"]++;\nvar h = READMEM(regPairs["+la+"]); regPairs["+la+"]++;\nregPairs["+r+"] = (h<<8) | l;"},Zr=function(r){return"regPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+r+"] >> 8);\nregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+r+"] & 0xff);"},jr=function(r,e){var a,s;return s=xe(e,!0),a=255^1<<r,s.getter+"\n"+s.v+" &= "+a+";\n"+s.setter},Qr=function(){return"var l = READMEM(regPairs["+la+"]); regPairs["+la+"]++;\nvar h = READMEM(regPairs["+la+"]); regPairs["+la+"]++; \nregPairs["+oa+"] = (h<<8) | l;"},$r=function(r,e){var a;return a="regs["+Se+"] & "+r,e||(a="!("+a+")"),"if ("+a+") {\n\tvar l = READMEM(regPairs["+la+"]); regPairs["+la+"]++;\n\tvar h = READMEM(regPairs["+la+"]); regPairs["+la+"]++;\n\tregPairs["+oa+"] = (h<<8) | l;\n}"},Gr=function(){return"iff1 = iff2;\n"+Qr()},Nr=function(r){var e;return e=xe(r,!0),e.getter+"\nvar rltemp = "+e.v+";\n"+e.v+" = ( ("+e.v+" << 1) | (regs["+Se+"] & "+I+") ) "+e.trunc+";\nregs["+Se+"] = ( rltemp >> 7 ) | sz53pTable["+e.v+"];\n"+e.setter},Jr=function(){return"var bytetemp = regs["+Re+"];\nregs["+Re+"] = (regs["+Re+"] << 1) | (regs["+Se+"] & "+I+");\nregs["+Se+"] = (regs["+Se+"] & "+(F|S|z)+") | (regs["+Re+"] & "+(T|B)+") | (bytetemp >> 7);"},Kr=function(r){var e;return e=xe(r,!0),e.getter+"\n"+e.v+" = ( ("+e.v+" << 1) | ("+e.v+" >> 7) ) "+e.trunc+";\nregs["+Se+"] = ("+e.v+" & "+I+") | sz53pTable["+e.v+"];\n"+e.setter},re=function(){return"var bytetemp =  READMEM(regPairs["+ia+"]);\nvar val = (bytetemp << 4) | (regs["+Re+"] & 0x0f);\nWRITEMEM(regPairs["+ia+"], val);\nregs["+Re+"] = (regs["+Re+"] & 0xf0) | (bytetemp >> 4);\nregs["+Se+"] = (regs["+Se+"] & "+I+") | sz53pTable[regs["+Re+"]];"},Vr=function(){return"regs["+Re+"] = (regs["+Re+"] << 1) | (regs["+Re+"] >> 7);\nregs["+Se+"] = (regs["+Se+"] & "+(F|S|z)+") | (regs["+Re+"] & "+(I|T|B)+");"},ee=function(r){var e;return e=xe(r,!0),e.getter+"\nvar rrtemp = "+e.v+";\n"+e.v+" = ( ("+e.v+" >> 1) | ( regs["+Se+"] << 7 ) ) "+e.trunc+";\nregs["+Se+"] = (rrtemp & "+I+") | sz53pTable["+e.v+"];\n"+e.setter},ae=function(){return"var bytetemp = regs["+Re+"];\nregs["+Re+"] = (bytetemp >> 1) | (regs["+Se+"] << 7);\nregs["+Se+"] = (regs["+Se+"] & "+(F|S|z)+") | (regs["+Re+"] & "+(T|B)+") | (bytetemp & "+I+");"},se=function(r){var e;return e=xe(r,!0),e.getter+"\nregs["+Se+"] = "+e.v+" & "+I+";\n"+e.v+" = ( ("+e.v+" >> 1) | ("+e.v+" << 7) ) "+e.trunc+";\nregs["+Se+"] |= sz53pTable["+e.v+"];\n"+e.setter},ie=function(){return"regs["+Se+"] = (regs["+Se+"] & "+(F|S|z)+") | (regs["+Re+"] & "+I+");\nregs["+Re+"] = (regs["+Re+"] >> 1) | (regs["+Re+"] << 7);\nregs["+Se+"] |= (regs["+Re+"] & "+(T|B)+");"},te=function(){return"var bytetemp = READMEM(regPairs["+ia+"]);\nvar val = (regs["+Re+"] << 4) | (bytetemp >> 4);\nWRITEMEM(regPairs["+ia+"], val);\nregs["+Re+"] = (regs["+Re+"] & 0xf0) | (bytetemp & 0x0f);\nregs["+Se+"] = (regs["+Se+"] & "+I+") | sz53pTable[regs["+Re+"]];"},ge=function(r){return"regPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] >> 8);\nregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] & 0xff);\nregPairs["+oa+"] = "+r+";"},ne=function(r){var e;return e=xe(r),e.getter+"\nvar sbctemp = regs["+Re+"] - "+e.v+" - (regs["+Se+"] & "+I+");\nvar lookup = ( (regs["+Re+"] & 0x88) >> 3 ) | ( ("+e.v+" & 0x88) >> 2 ) | ( (sbctemp & 0x88) >> 1 );\nregs["+Re+"] = sbctemp;\nregs["+Se+"] = ( sbctemp & 0x100 ? "+I+" : 0 ) | "+w+" | halfcarrySubTable[lookup & 0x07] | overflowSubTable[lookup >> 4] | sz53Table[regs["+Re+"]];"},fe=function(r){return"var sub16temp = regPairs["+ia+"] - regPairs["+r+"] - (regs["+Se+"] & "+I+");\nvar lookup = ( (regPairs["+ia+"] & 0x8800) >> 11 ) | ( (regPairs["+r+"] & 0x8800) >> 10 ) | ( (sub16temp & 0x8800) >>  9 );\nregPairs["+ia+"] = sub16temp;\nregs["+Se+"] = ( sub16temp & 0x10000 ? "+I+" : 0 ) | "+w+" | overflowSubTable[lookup >> 4] | (regs["+qe+"] & "+(T|B|z)+") | halfcarrySubTable[lookup&0x07] | (regPairs["+ia+"] ? 0 : "+S+");"},oe=function(){return"regs["+Se+"] = (regs["+Se+"] & "+(F|S|z)+") | (regs["+Re+"] & "+(T|B)+") | "+I+";"},le=function(r,e){var a,s;return a=1<<r,s=xe(e,!0),s.getter+"\n"+s.v+" |= "+a+";\n"+s.setter},Pe=function(r){return"opcodePrefix = '"+r+"';\ninterruptible = false;"},de=function(r){var e;return e=xe(r,!0),e.getter+"\nregs["+Se+"] = "+e.v+" >> 7;\n"+e.v+" = ("+e.v+" << 1) "+e.trunc+";\nregs["+Se+"] |= sz53pTable["+e.v+"];\n"+e.setter},ve=function(r){var e;return e=xe(r,!0),e.getter+"\nregs["+Se+"] =  "+e.v+" >> 7;\n"+e.v+" = ((("+e.v+") << 1) "+e.trunc+") | 0x01;\nregs["+Se+"] |= sz53pTable["+e.v+"];\n"+e.setter},pe=function(r){var e;return e=xe(r,!0),e.getter+"\nregs["+Se+"] = "+e.v+" & "+I+";\n"+e.v+" = ( ("+e.v+" & 0x80) | ("+e.v+" >> 1) ) "+e.trunc+";\nregs["+Se+"] |= sz53pTable["+e.v+"];\n"+e.setter},ue=function(r){var e;return e=xe(r,!0),e.getter+"\nregs["+Se+"] =  "+e.v+" & "+I+";\n"+e.v+" >>= 1;\nregs["+Se+"] |= sz53pTable["+e.v+"];\n"+e.setter},Ee=function(r){var e;return e=xe(r),e.getter+"\nvar subtemp = regs["+Re+"] - "+e.v+";\nvar lookup = ( (regs["+Re+"] & 0x88) >> 3 ) | ( ("+e.v+" & 0x88) >> 2 ) | ( (subtemp & 0x88) >> 1 );\nregs["+Re+"] = subtemp;\nregs["+Se+"] = ( subtemp & 0x100 ? "+I+" : 0 ) | "+w+" | halfcarrySubTable[lookup & 0x07] | overflowSubTable[lookup >> 4] | sz53Table[regs["+Re+"]];"},ce=function(r){var e;return e=xe(r),e.getter+"\nregs["+Re+"] ^= "+e.v+";\nregs["+Se+"] = sz53pTable[regs["+Re+"]];"},He=function(r,e,a){var s,t,g,n,f,o,l,P,d;for(null==e&&(e={}),null==a&&(a=[]),g=[],n=f=0;256>f;n=++f)P=r[n],null==P&&(P=e[n]),null!=P&&(l=function(){var r,e,g,f;for(f=[],r=0,e=a.length;r<e;r++)g=a[r],t=g[0],o=g[1],s=g[2],o===n&&f.push([t,s]);return f}(),d=function(){var r,e,a,g;for(g=[],r=0,e=l.length;r<e;r++)a=l[r],t=a[0],s=a[1],g.push("if (regPairs["+oa+"] == "+(65535&t+1)+" && !("+s+")) break;");return g}(),g.push("case "+n+":\n\t"+d.join("\n")+"\n\t"+P+"\n\tbreak;"));return"switch (opcode) {\n\t"+g.join("")+"\n\tdefault:\n\t\tvar addr = regPairs["+oa+"] - 1;\n\t\tthrow(\"Unimplemented opcode \" + opcode + \" in page "+r[256]+" - PC = \" + addr);\n}"},Rr={0:Kr("B"),1:Kr("C"),2:Kr("D"),3:Kr("E"),4:Kr("H"),5:Kr("L"),6:Kr("(HL)"),7:Kr("A"),8:se("B"),9:se("C"),10:se("D"),11:se("E"),12:se("H"),13:se("L"),14:se("(HL)"),15:se("A"),16:Nr("B"),17:Nr("C"),18:Nr("D"),19:Nr("E"),20:Nr("H"),21:Nr("L"),22:Nr("(HL)"),23:Nr("A"),24:ee("B"),25:ee("C"),26:ee("D"),27:ee("E"),28:ee("H"),29:ee("L"),30:ee("(HL)"),31:ee("A"),32:de("B"),33:de("C"),34:de("D"),35:de("E"),36:de("H"),37:de("L"),38:de("(HL)"),39:de("A"),40:pe("B"),41:pe("C"),42:pe("D"),43:pe("E"),44:pe("H"),45:pe("L"),46:pe("(HL)"),47:pe("A"),48:ve("B"),49:ve("C"),50:ve("D"),51:ve("E"),52:ve("H"),53:ve("L"),54:ve("(HL)"),55:ve("A"),56:ue("B"),57:ue("C"),58:ue("D"),59:ue("E"),60:ue("H"),61:ue("L"),62:ue("(HL)"),63:ue("A"),64:n(0,Te),65:n(0,Ie),66:n(0,we),67:n(0,ze),68:n(0,qe),69:n(0,Qe),70:f(0),71:n(0,Re),72:n(1,Te),73:n(1,Ie),74:n(1,we),75:n(1,ze),76:n(1,qe),77:n(1,Qe),78:f(1),79:n(1,Re),80:n(2,Te),81:n(2,Ie),82:n(2,we),83:n(2,ze),84:n(2,qe),85:n(2,Qe),86:f(2),87:n(2,Re),88:n(3,Te),89:n(3,Ie),90:n(3,we),91:n(3,ze),92:n(3,qe),93:n(3,Qe),94:f(3),95:n(3,Re),96:n(4,Te),97:n(4,Ie),98:n(4,we),99:n(4,ze),100:n(4,qe),101:n(4,Qe),102:f(4),103:n(4,Re),104:n(5,Te),105:n(5,Ie),106:n(5,we),107:n(5,ze),108:n(5,qe),109:n(5,Qe),110:f(5),111:n(5,Re),112:n(6,Te),113:n(6,Ie),114:n(6,we),115:n(6,ze),116:n(6,qe),117:n(6,Qe),118:f(6),119:n(6,Re),120:n(7,Te),121:n(7,Ie),122:n(7,we),123:n(7,ze),124:n(7,qe),125:n(7,Qe),126:f(7),127:n(7,Re),128:jr(0,"B"),129:jr(0,"C"),130:jr(0,"D"),131:jr(0,"E"),132:jr(0,"H"),133:jr(0,"L"),134:jr(0,"(HL)"),135:jr(0,"A"),136:jr(1,"B"),137:jr(1,"C"),138:jr(1,"D"),139:jr(1,"E"),140:jr(1,"H"),141:jr(1,"L"),142:jr(1,"(HL)"),143:jr(1,"A"),144:jr(2,"B"),145:jr(2,"C"),146:jr(2,"D"),147:jr(2,"E"),148:jr(2,"H"),149:jr(2,"L"),150:jr(2,"(HL)"),151:jr(2,"A"),152:jr(3,"B"),153:jr(3,"C"),154:jr(3,"D"),155:jr(3,"E"),156:jr(3,"H"),157:jr(3,"L"),158:jr(3,"(HL)"),159:jr(3,"A"),160:jr(4,"B"),161:jr(4,"C"),162:jr(4,"D"),163:jr(4,"E"),164:jr(4,"H"),165:jr(4,"L"),166:jr(4,"(HL)"),167:jr(4,"A"),168:jr(5,"B"),169:jr(5,"C"),170:jr(5,"D"),171:jr(5,"E"),172:jr(5,"H"),173:jr(5,"L"),174:jr(5,"(HL)"),175:jr(5,"A"),176:jr(6,"B"),177:jr(6,"C"),178:jr(6,"D"),179:jr(6,"E"),180:jr(6,"H"),181:jr(6,"L"),182:jr(6,"(HL)"),183:jr(6,"A"),184:jr(7,"B"),185:jr(7,"C"),186:jr(7,"D"),187:jr(7,"E"),188:jr(7,"H"),189:jr(7,"L"),190:jr(7,"(HL)"),191:jr(7,"A"),192:le(0,"B"),193:le(0,"C"),194:le(0,"D"),195:le(0,"E"),196:le(0,"H"),197:le(0,"L"),198:le(0,"(HL)"),199:le(0,"A"),200:le(1,"B"),201:le(1,"C"),202:le(1,"D"),203:le(1,"E"),204:le(1,"H"),205:le(1,"L"),206:le(1,"(HL)"),207:le(1,"A"),208:le(2,"B"),209:le(2,"C"),210:le(2,"D"),211:le(2,"E"),212:le(2,"H"),213:le(2,"L"),214:le(2,"(HL)"),215:le(2,"A"),216:le(3,"B"),217:le(3,"C"),218:le(3,"D"),219:le(3,"E"),220:le(3,"H"),221:le(3,"L"),222:le(3,"(HL)"),223:le(3,"A"),224:le(4,"B"),225:le(4,"C"),226:le(4,"D"),227:le(4,"E"),228:le(4,"H"),229:le(4,"L"),230:le(4,"(HL)"),231:le(4,"A"),232:le(5,"B"),233:le(5,"C"),234:le(5,"D"),235:le(5,"E"),236:le(5,"H"),237:le(5,"L"),238:le(5,"(HL)"),239:le(5,"A"),240:le(6,"B"),241:le(6,"C"),242:le(6,"D"),243:le(6,"E"),244:le(6,"H"),245:le(6,"L"),246:le(6,"(HL)"),247:le(6,"A"),248:le(7,"B"),249:le(7,"C"),250:le(7,"D"),251:le(7,"E"),252:le(7,"H"),253:le(7,"L"),254:le(7,"(HL)"),255:le(7,"A"),256:"cb"},he=function(r){var e,a,s,t,g,n;return"DDCB"===r?(g=na,e=Ue,s=Oe,n="IX",a="IXH",t="IXL"):(g=fa,e=Ze,s=je,n="IY",a="IYH",t="IYL"),{0:lr("B",Kr,g),1:lr("C",Kr,g),2:lr("D",Kr,g),3:lr("E",Kr,g),4:lr("H",Kr,g),5:lr("L",Kr,g),6:Kr("("+n+"+nn)"),7:lr("A",Kr,g),8:lr("B",se,g),9:lr("C",se,g),10:lr("D",se,g),11:lr("E",se,g),12:lr("H",se,g),13:lr("L",se,g),14:se("("+n+"+nn)"),15:lr("A",se,g),16:lr("B",Nr,g),17:lr("C",Nr,g),18:lr("D",Nr,g),19:lr("E",Nr,g),20:lr("H",Nr,g),21:lr("L",Nr,g),22:Nr("("+n+"+nn)"),23:lr("A",Nr,g),24:lr("B",ee,g),25:lr("C",ee,g),26:lr("D",ee,g),27:lr("E",ee,g),28:lr("H",ee,g),29:lr("L",ee,g),30:ee("("+n+"+nn)"),31:lr("A",ee,g),32:lr("B",de,g),33:lr("C",de,g),34:lr("D",de,g),35:lr("E",de,g),36:lr("H",de,g),37:lr("L",de,g),38:de("("+n+"+nn)"),39:lr("A",de,g),40:lr("B",pe,g),41:lr("C",pe,g),42:lr("D",pe,g),43:lr("E",pe,g),44:lr("H",pe,g),45:lr("L",pe,g),46:pe("("+n+"+nn)"),47:lr("A",pe,g),48:lr("B",ve,g),49:lr("C",ve,g),50:lr("D",ve,g),51:lr("E",ve,g),52:lr("H",ve,g),53:lr("L",ve,g),54:ve("("+n+"+nn)"),55:lr("A",ve,g),56:lr("B",ue,g),57:lr("C",ue,g),58:lr("D",ue,g),59:lr("E",ue,g),60:lr("H",ue,g),61:lr("L",ue,g),62:ue("("+n+"+nn)"),63:lr("A",ue,g),64:o(0,g),65:o(0,g),66:o(0,g),67:o(0,g),68:o(0,g),69:o(0,g),70:o(0,g),71:o(0,g),72:o(1,g),73:o(1,g),74:o(1,g),75:o(1,g),76:o(1,g),77:o(1,g),78:o(1,g),79:o(1,g),80:o(2,g),81:o(2,g),82:o(2,g),83:o(2,g),84:o(2,g),85:o(2,g),86:o(2,g),87:o(2,g),88:o(3,g),89:o(3,g),90:o(3,g),91:o(3,g),92:o(3,g),93:o(3,g),94:o(3,g),95:o(3,g),96:o(4,g),97:o(4,g),98:o(4,g),99:o(4,g),100:o(4,g),101:o(4,g),102:o(4,g),103:o(4,g),104:o(5,g),105:o(5,g),106:o(5,g),107:o(5,g),108:o(5,g),109:o(5,g),110:o(5,g),111:o(5,g),112:o(6,g),113:o(6,g),114:o(6,g),115:o(6,g),116:o(6,g),117:o(6,g),118:o(6,g),119:o(6,g),120:o(7,g),121:o(7,g),122:o(7,g),123:o(7,g),124:o(7,g),125:o(7,g),126:o(7,g),127:o(7,g),128:sr("B",jr,0,g),129:sr("C",jr,0,g),130:sr("D",jr,0,g),131:sr("E",jr,0,g),132:sr("H",jr,0,g),133:sr("L",jr,0,g),134:jr(0,"("+n+"+nn)"),135:sr("A",jr,0,g),136:sr("B",jr,1,g),137:sr("C",jr,1,g),138:sr("D",jr,1,g),139:sr("E",jr,1,g),140:sr("H",jr,1,g),141:sr("L",jr,1,g),142:jr(1,"("+n+"+nn)"),143:sr("A",jr,1,g),144:sr("B",jr,2,g),145:sr("C",jr,2,g),146:sr("D",jr,2,g),147:sr("E",jr,2,g),148:sr("H",jr,2,g),149:sr("L",jr,2,g),150:jr(2,"("+n+"+nn)"),151:sr("A",jr,2,g),152:sr("B",jr,3,g),153:sr("C",jr,3,g),154:sr("D",jr,3,g),155:sr("E",jr,3,g),156:sr("H",jr,3,g),157:sr("L",jr,3,g),158:jr(3,"("+n+"+nn)"),159:sr("A",jr,3,g),160:sr("B",jr,4,g),161:sr("C",jr,4,g),162:sr("D",jr,4,g),163:sr("E",jr,4,g),164:sr("H",jr,4,g),165:sr("L",jr,4,g),166:jr(4,"("+n+"+nn)"),167:sr("A",jr,4,g),168:sr("B",jr,5,g),169:sr("C",jr,5,g),170:sr("D",jr,5,g),171:sr("E",jr,5,g),172:sr("H",jr,5,g),173:sr("L",jr,5,g),174:jr(5,"("+n+"+nn)"),175:sr("A",jr,5,g),176:sr("B",jr,6,g),177:sr("C",jr,6,g),178:sr("D",jr,6,g),179:sr("E",jr,6,g),180:sr("H",jr,6,g),181:sr("L",jr,6,g),182:jr(6,"("+n+"+nn)"),183:sr("A",jr,6,g),184:sr("B",jr,7,g),185:sr("C",jr,7,g),186:sr("D",jr,7,g),187:sr("E",jr,7,g),188:sr("H",jr,7,g),189:sr("L",jr,7,g),190:jr(7,"("+n+"+nn)"),191:sr("A",jr,7,g),192:sr("B",le,0,g),193:sr("C",le,0,g),194:sr("D",le,0,g),195:sr("E",le,0,g),196:sr("H",le,0,g),197:sr("L",le,0,g),198:le(0,"("+n+"+nn)"),199:sr("A",le,0,g),200:sr("B",le,1,g),201:sr("C",le,1,g),202:sr("D",le,1,g),203:sr("E",le,1,g),204:sr("H",le,1,g),205:sr("L",le,1,g),206:le(1,"("+n+"+nn)"),207:sr("A",le,1,g),208:sr("B",le,2,g),209:sr("C",le,2,g),210:sr("D",le,2,g),211:sr("E",le,2,g),212:sr("H",le,2,g),213:sr("L",le,2,g),214:le(2,"("+n+"+nn)"),215:sr("A",le,2,g),216:sr("B",le,3,g),217:sr("C",le,3,g),218:sr("D",le,3,g),219:sr("E",le,3,g),220:sr("H",le,3,g),221:sr("L",le,3,g),222:le(3,"("+n+"+nn)"),223:sr("A",le,3,g),224:sr("B",le,4,g),225:sr("C",le,4,g),226:sr("D",le,4,g),227:sr("E",le,4,g),228:sr("H",le,4,g),229:sr("L",le,4,g),230:le(4,"("+n+"+nn)"),231:sr("A",le,4,g),232:sr("B",le,5,g),233:sr("C",le,5,g),234:sr("D",le,5,g),235:sr("E",le,5,g),236:sr("H",le,5,g),237:sr("L",le,5,g),238:le(5,"("+n+"+nn)"),239:sr("A",le,5,g),240:sr("B",le,6,g),241:sr("C",le,6,g),242:sr("D",le,6,g),243:sr("E",le,6,g),244:sr("H",le,6,g),245:sr("L",le,6,g),246:le(6,"("+n+"+nn)"),247:sr("A",le,6,g),248:sr("B",le,7,g),249:sr("C",le,7,g),250:sr("D",le,7,g),251:sr("E",le,7,g),252:sr("H",le,7,g),253:sr("L",le,7,g),254:le(7,"("+n+"+nn)"),255:sr("A",le,7,g),256:"ddcb"}},Tr=he("DDCB"),kr=he("FDCB"),De=function(r){var a,n,f,o,l,P;return"DD"===r?(l=na,a=Ue,f=Oe,P="IX",n="IXH",o="IXL"):(l=fa,a=Ze,f=je,P="IY",n="IYH",o="IYL"),{9:t(l,ra),25:t(l,aa),33:dr(l),34:Ar(l),35:_(l),36:X(n),37:D(n),38:ur(a),41:t(l,l),42:pr(l),43:h(l),44:X(o),45:D(o),46:ur(f),52:X("("+P+"+nn)"),53:D("("+P+"+nn)"),54:hr(l),57:t(l,la),68:Er(Te,a),69:Er(Te,f),70:mr(Te,l),76:Er(Ie,a),77:Er(Ie,f),78:mr(Ie,l),84:Er(we,a),85:Er(we,f),86:mr(we,l),92:Er(ze,a),93:Er(ze,f),94:mr(ze,l),96:Er(a,Te),97:Er(a,Ie),98:Er(a,we),99:Er(a,ze),100:Er(a,a),101:Er(a,f),102:mr(qe,l),103:Er(a,Re),104:Er(f,Te),105:Er(f,Ie),106:Er(f,we),107:Er(f,ze),108:Er(f,a),109:Er(f,f),110:mr(Qe,l),111:Er(f,Re),112:xr(l,Te),113:xr(l,Ie),114:xr(l,we),115:xr(l,ze),116:xr(l,qe),117:xr(l,Qe),119:xr(l,Re),124:Er(Re,a),125:Er(Re,f),126:mr(Re,l),132:s(n),133:s(o),134:s("("+P+"+nn)"),140:e(n),141:e(o),142:e("("+P+"+nn)"),148:Ee(n),149:Ee(o),150:Ee("("+P+"+nn)"),156:ne(n),157:ne(o),158:ne("("+P+"+nn)"),164:g(n),165:g(o),166:g("("+P+"+nn)"),172:ce(n),173:ce(o),174:ce("("+P+"+nn)"),180:wr(n),181:wr(o),182:wr("("+P+"+nn)"),188:A(n),189:A(o),190:A("("+P+"+nn)"),203:Pe(r+"CB"),221:Pe("DD"),225:Or(l),227:C(l),229:Zr(l),233:rr(l),249:vr(la,l),253:Pe("FD"),256:"dd"}},Cr=De("DD"),Br={64:J(Te),65:_r(Te),66:fe(ra),67:Ar(ra),68:yr(),69:Gr(),70:q(0),71:Er(_e,Re),72:J(Ie),73:_r(Ie),74:a(ra),75:pr(ra),76:yr(),77:Gr(),78:q(0),79:Er($e,Re),80:J(we),81:_r(we),82:fe(aa),83:Ar(aa),84:yr(),85:Gr(),86:q(1),87:Er(Re,_e),88:J(ze),89:_r(ze),90:a(aa),91:pr(aa),92:yr(),93:Gr(),94:q(2),95:Er(Re,$e),96:J(qe),97:_r(qe),98:fe(ia),99:Ar(ia),100:yr(),101:Gr(),102:q(0),103:te(),104:J(Qe),105:_r(Qe),106:a(ia),107:pr(ia,!0),108:yr(),109:Gr(),110:q(0),111:re(),112:N(),113:Xr(),114:fe(la),115:Ar(la),116:yr(),117:Gr(),118:q(1),120:J(Re),121:_r(Re),122:a(la),123:pr(la),124:yr(),125:Gr(),126:q(2),160:gr(),161:u(),162:Z(),163:Yr(),168:ir(),169:v(),170:U(),171:Sr(),176:nr(),177:E(),178:j(),179:zr(),184:tr(),185:p(),186:O(),187:Fr(),256:"ed"},Ir=De("FD"),Hr={0:Lr(),1:dr(ra),2:Dr(ra,Re),3:_(ra),4:X("B"),5:D("B"),6:ur(Te),7:Vr(),8:R(Ke,Ve),9:t(ia,ra),10:cr(Re,ra),11:h(ra),12:X("C"),13:D("C"),14:ur(Ie),15:ie(),16:y(),17:dr(aa),18:Dr(aa,Re),19:_(aa),20:X("D"),21:D("D"),22:ur(we),23:Jr(),24:ar(),25:t(ia,aa),26:cr(Re,aa),27:h(aa),28:X("E"),29:D("E"),30:ur(ze),31:ae(),32:er(S,!1),33:dr(ia),34:Ar(ia),35:_(ia),36:X("H"),37:D("H"),38:ur(qe),39:b(),40:er(S,!0),41:t(ia,ia),42:pr(ia),43:h(ia),44:X("L"),45:D("L"),46:ur(Qe),47:M(),48:er(I,!1),49:dr(la),50:Mr(),51:_(la),52:X("(HL)"),53:D("(HL)"),54:br(ia),55:oe(),56:er(I,!0),57:t(ia,la),58:Pr(),59:h(la),60:X("A"),61:D("A"),62:ur(Re),63:d(),64:Er(Te,Te),65:Er(Te,Ie),66:Er(Te,we),67:Er(Te,ze),68:Er(Te,qe),69:Er(Te,Qe),70:cr(Te,ia),71:Er(Te,Re),72:Er(Ie,Te),73:Er(Ie,Ie),74:Er(Ie,we),75:Er(Ie,ze),76:Er(Ie,qe),77:Er(Ie,Qe),78:cr(Ie,ia),79:Er(Ie,Re),80:Er(we,Te),81:Er(we,Ie),82:Er(we,we),83:Er(we,ze),84:Er(we,qe),85:Er(we,Qe),86:cr(we,ia),87:Er(we,Re),88:Er(ze,Te),89:Er(ze,Ie),90:Er(ze,we),91:Er(ze,ze),92:Er(ze,qe),93:Er(ze,Qe),94:cr(ze,ia),95:Er(ze,Re),96:Er(qe,Te),97:Er(qe,Ie),98:Er(qe,we),99:Er(qe,ze),100:Er(qe,qe),101:Er(qe,Qe),102:cr(qe,ia),103:Er(qe,Re),104:Er(Qe,Te),105:Er(Qe,Ie),106:Er(Qe,we),107:Er(Qe,ze),108:Er(Qe,qe),109:Er(Qe,Qe),110:cr(Qe,ia),111:Er(Qe,Re),112:Dr(ia,Te),113:Dr(ia,Ie),114:Dr(ia,we),115:Dr(ia,ze),116:Dr(ia,qe),117:Dr(ia,Qe),118:Y(),119:Dr(ia,Re),120:Er(Re,Te),121:Er(Re,Ie),122:Er(Re,we),123:Er(Re,ze),124:Er(Re,qe),125:Er(Re,Qe),126:cr(Re,ia),127:Er(Re,Re),128:s("B"),129:s("C"),130:s("D"),131:s("E"),132:s("H"),133:s("L"),134:s("(HL)"),135:s("A"),136:e("B"),137:e("C"),138:e("D"),139:e("E"),140:e("H"),141:e("L"),142:e("(HL)"),143:e("A"),144:Ee("B"),145:Ee("C"),146:Ee("D"),147:Ee("E"),148:Ee("H"),149:Ee("L"),150:Ee("(HL)"),151:Ee("A"),152:ne("B"),153:ne("C"),154:ne("D"),155:ne("E"),156:ne("H"),157:ne("L"),158:ne("(HL)"),159:ne("A"),160:g("B"),161:g("C"),162:g("D"),163:g("E"),164:g("H"),165:g("L"),166:g("(HL)"),167:g("A"),168:ce("B"),169:ce("C"),170:ce("D"),171:ce("E"),172:ce("H"),173:ce("L"),174:ce("(HL)"),175:ce("A"),176:wr("B"),177:wr("C"),178:wr("D"),179:wr("E"),180:wr("H"),181:wr("L"),182:wr("(HL)"),183:wr("A"),184:A("B"),185:A("C"),186:A("D"),187:A("E"),188:A("H"),189:A("L"),190:A("(HL)"),191:A("A"),192:$r(S,!1),193:Or(ra),194:K(S,!1),195:V(),196:l(S,!1),197:Zr(ra),198:s("nn"),199:ge(0),200:$r(S,!0),201:Qr(),202:K(S,!0),203:Pe("CB"),204:l(S,!0),205:P(),206:e("nn"),207:ge(8),208:$r(I,!1),209:Or(aa),210:K(I,!1),211:Ur(),212:l(I,!1),213:Zr(aa),214:Ee("nn"),215:ge(16),216:$r(I,!0),217:H(),218:K(I,!0),219:$(),220:l(I,!0),221:Pe("DD"),222:ne("nn"),223:ge(24),224:$r(F,!1),225:Or(ia),226:K(F,!1),227:C(ia),228:l(F,!1),229:Zr(ia),230:g("nn"),231:ge(32),232:$r(F,!0),233:rr(ia),234:K(F,!0),235:R(aa,ia),236:l(F,!0),237:Pe("ED"),238:ce("nn"),239:ge(40),240:$r(z,!1),241:Or(Ke),242:K(z,!1),243:x(),244:l(z,!1),245:Zr(Ke),246:wr("nn"),247:ge(48),248:$r(z,!0),249:vr(la,ia),250:K(z,!0),251:L(),252:l(z,!0),253:Pe("FD"),254:A("nn"),255:ge(56),256:0},me="(function(opts) {\n\tvar self = {};\n\n\t"+Pa+"\n\n\tself.requestInterrupt = function() {\n\t\tinterruptPending = true;\n\t\t/* TODO: use event scheduling to keep the interrupt line active for a fixed\n\t\t~48T window, to support retriggered interrupts and interrupt blocking via\n\t\tchains of EI or DD/FD prefixes */\n\t}\n\tvar z80Interrupt = function() {\n\t\tif (iff1) {\n\t\t\tif (halted) {\n\t\t\t\t/* move PC on from the HALT opcode */\n\t\t\t\tregPairs["+oa+"]++;\n\t\t\t\thalted = false;\n\t\t\t}\n\n\t\t\tiff1 = iff2 = 0;\n\n\t\t\t/* push current PC in readiness for call to interrupt handler */\n\t\t\tregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] >> 8);\n\t\t\tregPairs["+la+"]--; WRITEMEM(regPairs["+la+"], regPairs["+oa+"] & 0xff);\n\t\t\t\n\t\t\t/* TODO: R register */\n\t\t\t\n\t\t\tswitch (im) {\n\t\t\t\tcase 0:\n\t\t\t\t\tregPairs["+oa+"] = 0x0038;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tregPairs["+oa+"] = 0x0038;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tinttemp = (regs["+_e+"] << 8) | 0xff;\n\t\t\t\t\tl = READMEM(inttemp);\n\t\t\t\t\tinttemp = (inttemp+1) & 0xffff;\n\t\t\t\t\th = READMEM(inttemp);\n\t\t\t\t\tregPairs["+oa+"] = (h<<8) | l;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t};\n\n\tself.runRoutine = function(pcAddr, spAddr) {\n\t\tvar lastOpcodePrefix, offset, opcode;\n\n\t\tregPairs["+oa+"] = pcAddr;\n\t\tregPairs["+la+"] = spAddr;\n\t\tmemory.write(regPairs["+la+"], 0);\n\t\tmemory.write((regPairs[("+la+")] + 1) & 0xffff, 0);\n\n\t\tfor (var instructionCount = 0; instructionCount < 1000000; instructionCount++) {\n\t\t\tif (regPairs["+oa+"] == 0x0000) break;\n\n\t\t\tif (interruptible && interruptPending) {\n\t\t\t\tz80Interrupt();\n\t\t\t\tinterruptPending = false;\n\t\t\t}\n\t\t\tinterruptible = true; /* unless overridden by opcode */\n\t\t\tlastOpcodePrefix = opcodePrefix;\n\t\t\topcodePrefix = '';\n\t\t\tswitch (lastOpcodePrefix) {\n\t\t\t\tcase '':\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\t"+He(Hr,null,r.traps)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'CB':\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\t"+He(Rr)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DD':\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\t"+He(Cr,Hr)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'DDCB':\n\t\t\t\t\toffset = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\tif (offset & 0x80) offset -= 0x100;\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]);\n\t\t\t\t\tregPairs["+oa+"]++;\n\t\t\t\t\t"+He(Tr)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ED':\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\t"+He(Br)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'FD':\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\t"+He(Ir,Hr)+"\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'FDCB':\n\t\t\t\t\toffset = READMEM(regPairs["+oa+"]); regPairs["+oa+"]++;\n\t\t\t\t\tif (offset & 0x80) offset -= 0x100;\n\t\t\t\t\topcode = memory.read(regPairs["+oa+"]);\n\t\t\t\t\tregPairs["+oa+"]++;\n\t\t\t\t\t"+He(kr)+"\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow(\"Unknown opcode prefix: \" + lastOpcodePrefix);\n\t\t\t}\n\t\t}\n\t\treturn instructionCount;\n\t};\n\n\tself.reset = function() {\n\t\tregPairs["+oa+"] = regPairs["+ga+"] = 0;\n\t\tiff1 = 0; iff2 = 0; im = 0; halted = false;\n\t};\n\n\tself.loadFromSnapshot = function(snapRegs) {\n\t\tregPairs["+Ke+"] = snapRegs['AF'];\n\t\tregPairs["+ra+"] = snapRegs['BC'];\n\t\tregPairs["+aa+"] = snapRegs['DE'];\n\t\tregPairs["+ia+"] = snapRegs['HL'];\n\t\tregPairs["+Ve+"] = snapRegs['AF_'];\n\t\tregPairs["+ea+"] = snapRegs['BC_'];\n\t\tregPairs["+sa+"] = snapRegs['DE_'];\n\t\tregPairs["+ta+"] = snapRegs['HL_'];\n\t\tregPairs["+na+"] = snapRegs['IX'];\n\t\tregPairs["+fa+"] = snapRegs['IY'];\n\t\tregPairs["+la+"] = snapRegs['SP'];\n\t\tregPairs["+oa+"] = snapRegs['PC'];\n\t\tregPairs["+ga+"] = snapRegs['IR'];\n\t\tiff1 = snapRegs['iff1'];\n\t\tiff2 = snapRegs['iff2'];\n\t\tim = snapRegs['im'];\n\t};\n\n\t/* Register / flag accessors (used for tape trapping and test harness) */\n\tself.getAF = function() {\n\t\treturn regPairs["+Ke+"];\n\t}\n\tself.getBC = function() {\n\t\treturn regPairs["+ra+"];\n\t}\n\tself.getDE = function() {\n\t\treturn regPairs["+aa+"];\n\t}\n\tself.getHL = function() {\n\t\treturn regPairs["+ia+"];\n\t}\n\tself.getAF_ = function() {\n\t\treturn regPairs["+Ve+"];\n\t}\n\tself.getBC_ = function() {\n\t\treturn regPairs["+ea+"];\n\t}\n\tself.getDE_ = function() {\n\t\treturn regPairs["+sa+"];\n\t}\n\tself.getHL_ = function() {\n\t\treturn regPairs["+ta+"];\n\t}\n\tself.getIX = function() {\n\t\treturn regPairs["+na+"];\n\t}\n\tself.getIY = function() {\n\t\treturn regPairs["+fa+"];\n\t}\n\tself.getI = function() {\n\t\treturn regs["+_e+"];\n\t}\n\tself.getR = function() {\n\t\treturn regs["+$e+"];\n\t}\n\tself.getSP = function() {\n\t\treturn regPairs["+la+"];\n\t}\n\tself.getPC = function() {\n\t\treturn regPairs["+oa+"];\n\t}\n\tself.getIFF1 = function() {\n\t\treturn iff1;\n\t}\n\tself.getIFF2 = function() {\n\t\treturn iff2;\n\t}\n\tself.getIM = function() {\n\t\treturn im;\n\t}\n\tself.getHalted = function() {\n\t\treturn halted;\n\t}\n\n\tself.setAF = function(val) {\n\t\tregPairs["+Ke+"] = val;\n\t}\n\tself.setBC = function(val) {\n\t\tregPairs["+ra+"] = val;\n\t}\n\tself.setDE = function(val) {\n\t\tregPairs["+aa+"] = val;\n\t}\n\tself.setHL = function(val) {\n\t\tregPairs["+ia+"] = val;\n\t}\n\tself.setAF_ = function(val) {\n\t\tregPairs["+Ve+"] = val;\n\t}\n\tself.setBC_ = function(val) {\n\t\tregPairs["+ea+"] = val;\n\t}\n\tself.setDE_ = function(val) {\n\t\tregPairs["+sa+"] = val;\n\t}\n\tself.setHL_ = function(val) {\n\t\tregPairs["+ta+"] = val;\n\t}\n\tself.setIX = function(val) {\n\t\tregPairs["+na+"] = val;\n\t}\n\tself.setIY = function(val) {\n\t\tregPairs["+fa+"] = val;\n\t}\n\tself.setI = function(val) {\n\t\tregs["+_e+"] = val;\n\t}\n\tself.setR = function(val) {\n\t\tregs["+$e+"] = val;\n\t}\n\tself.setSP = function(val) {\n\t\tregPairs["+la+"] = val;\n\t}\n\tself.setPC = function(val) {\n\t\tregPairs["+oa+"] = val;\n\t}\n\tself.setIFF1 = function(val) {\n\t\tiff1 = val;\n\t}\n\tself.setIFF2 = function(val) {\n\t\tiff2 = val;\n\t}\n\tself.setIM = function(val) {\n\t\tim = val;\n\t}\n\tself.setHalted = function(val) {\n\t\thalted = val;\n\t}\n\n\tself.getCarry_ = function() {\n\t\treturn regs["+Ye+"] & "+I+";\n\t};\n\tself.setCarry = function(val) {\n\t\tif (val) {\n\t\t\tregs["+Se+"] |= "+I+";\n\t\t} else {\n\t\t\tregs["+Se+"] &= "+~I+";\n\t\t}\n\t};\n\tself.getA_ = function() {\n\t\treturn regs["+Ce+"];\n\t};\n\n\treturn self;\n})",me=me.replace(/READMEM\((.*?)\)/g,"memory.read($1)"),me=me.replace(/WRITEMEM\((.*?),(.*?)\)/g,"memory.write($1,$2);"),ye=eval,ye(me)}}).call(this),function(){function r(e,a,s,t){function g(r,e){49152==(49154&r)?ar=e:32768==(49154&r)&&(er[ar]=e,13==ar&&(er[14]=!0))}function n(){rr=!1,_[3]=O=1,K=r[O],_[3]++,_[2]=o(),$=r[_[2]]+1,Z=_[2]+1,j=o(),Q=o(),G=O+27,sr[0]=0;var e=l(j,33,0)+1;for(i=0;3>i;i++)tr[i]=0,nr[i]=0,fr[i]=0,dr[i]=e,or[i]=255;return N=0,V=1,void P()}function f(){var e,a;V--,0===V&&(V=K,e=0,d(e)&&(255==r[sr[0]]&&v(),sr[0]=p(e,sr[0])),e=1,d(e)&&(sr[1]=p(e,sr[1])),e=2,d(e)&&(sr[2]=p(e,sr[2]))),e=0,U[T]=u(e),a=U[T],c(nr[e],a),ir[7]=(U[T]|U[R])>>1,255==or[e]?ir[8]=0:(!U[T]&&(ir[6]=U[w]),U[y]=U[F],_[3]=m(e,_[2],a),ir[0]=U[F],ir[1]=U[w],ir[8]=U[y],M(e,8)),e=1,U[T]=u(e),255==or[e]?ir[9]=0:(a=U[T],c(nr[e],a),ir[7]|=U[T]|U[R],!U[T]&&(ir[6]=U[w]),U[y]=U[F],_[3]=m(e,_[2],a),ir[2]=U[F],ir[3]=U[w],ir[9]=U[y],M(e,9)),e=2,U[T]=u(e),255==or[e]?ir[10]=0:(a=U[T],c(nr[e],a),U[T]<<=1,U[R]<<=1,ir[7]|=U[T]|U[R],!U[T]&&(ir[6]=U[w]),U[y]=U[F],_[3]=m(e,_[2],a),ir[4]=U[F],ir[5]=U[w],ir[10]=U[y],M(e,10)),P()}function o(){return U[k]=r[_[3]],_[3]++,U[I]=r[_[3]],_[3]++,_[2]+O}function l(e,a,s){for(;r[e]!=s;)e+=a;return e}function P(){var r=13;0===ir[r]&&(r-=3);do g(65533,r),g(49149,ir[r]),r--;while(0<=r);_[1]=49149}function d(r){return lr[r]--,!!(128&lr[r])&&(lr[r]=Pr[r],!0)}function v(){var e=N;N>=$&&(rr=!0,N=0,e=0),N++;var a=(e<<1)+Z,s=r[a];U[T]=s,J=r[a+1],_[3]=l(Q,7,s)+1,sr[0]=o(),sr[1]=o(),sr[2]=o()}function p(e,a){for(var s;!0;){var t=r[a];if(96>t)return tr[e]=t,fr[e]=0,or[e]=32,a++,a;if(112>t)_[1]=99,nr[e]=l(G,99,t-96)+1,a++;else if(128>t)dr[e]=l(j,33,t-112)+1,gr[e]=0,a++;else{if(128==t)return a++,or[e]=255,a;if(129==t)return a++,a;130==t?(dr[e]=l(j,33,0)+1,gr[e]=0,a++):143>t?(ir[13]=t-128,a++,ir[11]=r[a],a++,gr[e]=1,dr[e]=l(j,33,0)+1):(t=255&t-161,lr[e]=t,Pr[e]=t,a++)}}}function u(e){var a,s,t;if(255==or[e])return U[T];if(a=255&or[e]-1,or[e]=a,s=fr[e],fr[e]=31&s+1,a)return s;var g=nr[e]+96;return t=255&r[g]-1,128&t?(or[e]=255,s):(fr[e]=31&t+1,or[e]=r[g+1]+1,t)}function c(e,s){var t;e+=255&3*s,t=r[e+1],U[T]=128&t?16:0,U[R]=64&t?2:0,U[w]=31&t,U[k]=r[e+2],t=r[e+0],U[I]=t>>4,U[F]=15&t,32&r[e+1]&&(U[I]|=16)}function m(e,a,s){var t=dr[e]+s,g=127&tr[e]+r[t]+J,n=vr[g];return 4096&a?n+(4095&a):n-a}function M(r,e){var a=gr[r];0!==a&&(2==a?ir[13]=0:gr[r]=2,ir[e]|=16)}s||(s={}),t||(t={});var b=new ArrayBuffer(2),h=new Uint16Array(b),x=new Uint8Array(b);h[0]=256;var y,R,T,I,k,w,F,z,W,S,Y,q=1==x[0],X=new ArrayBuffer(26),_=new Uint16Array(X),U=new Uint8Array(X);q?(y=0,R=2,T=3,I=4,k=5,w=6,F=7,z=8,W=9,S=10,Y=11):(y=1,R=3,T=2,I=5,k=4,w=7,F=6,z=9,W=8,S=11,Y=10);var r,O,Z,j,Q,G,$,N,J,K,V,rr,er=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,!1],ar=0,sr=new Uint16Array(3),ir=new Uint16Array(14),tr=new Uint8Array(3),gr=new Uint8Array(3),nr=new Uint16Array(3),fr=new Uint8Array(3),or=new Uint8Array(3),lr=new Uint8Array(3),Pr=new Uint8Array(3),dr=new Uint16Array(3),vr=new Uint16Array([3832,3600,3424,3200,3032,2856,2696,2544,2400,2272,2136,2016,1916,1800,1712,1600,1516,1428,1348,1272,1200,1136,1068,1008,958,900,856,800,758,714,674,636,600,568,534,504,479,450,428,400,379,357,337,318,300,284,267,252,239,225,214,200,189,178,168,159,150,142,133,126,119,112,107,100,94,89,84,79,75,71,66,63,59,56,53,50,47,44,42,39,37,35,33,31,29,28,26,25,23,22,21,19,18,17,16,15]);return new Cowbell.Common.AYGenerator(e,a,function(e,a){var g,o=[];for(r=new Uint8Array(e.length+1),r[0]=255,i=0;i<e.length;i++)r[1+i]=e[i];for(n();er[14]=!1,f(),!rr;)o.push(er.slice());a({ayRegisterLog:o,ayFrequency:t.ayFrequency||s.ayFrequency,commandFrequency:t.commandFrequency||s.commandFrequency,stereoMode:t.stereoMode||s.stereoMode,panning:t.panning||s.panning,ayMode:t.ayMode||s.ayMode})})}Cowbell.Player.ZXSTC=function(e){return new Cowbell.Common.WebAudioPlayer(r,e)}}(),Cowbell.Common.PT3PlayerBin=new Uint8Array([33,110,72,24,58,195,185,68,24,41,0,0,0,61,86,84,73,73,32,80,84,51,32,80,108,97,121,101,114,32,114,46,55,61,33,10,64,203,254,203,70,200,225,33,168,70,52,33,108,70,52,175,103,111,50,182,70,34,183,70,195,171,69,34,168,65,34,62,67,229,17,100,0,25,126,50,69,69,229,221,225,25,34,11,64,221,94,2,25,35,34,231,68,209,221,110,3,221,102,4,25,34,244,68,33,169,0,25,34,55,67,33,105,0,25,34,161,65,33,10,64,203,190,17,28,70,1,31,71,26,19,254,30,48,6,103,26,111,19,24,7,213,22,0,95,25,25,209,124,2,11,125,2,11,214,240,32,227,33,81,70,119,17,82,70,1,108,0,237,176,60,50,168,70,33,1,240,34,108,70,34,137,70,34,166,70,33,24,70,34,209,68,34,94,70,34,123,70,34,152,70,34,96,70,34,125,70,34,154,70,221,126,169,214,48,56,4,254,10,56,2,62,6,50,141,66,245,254,4,221,126,255,23,230,7,33,200,69,213,80,135,95,25,94,35,203,59,159,230,167,50,32,65,235,193,9,26,198,216,79,206,69,145,71,197,17,174,71,213,6,12,197,78,35,229,70,213,235,17,23,0,221,38,8,203,56,203,25,25,121,138,119,35,120,138,119,25,221,37,32,239,209,19,19,225,35,193,16,218,225,209,123,254,228,32,5,62,253,50,220,71,26,167,40,17,31,245,135,79,9,241,48,2,53,53,52,167,237,66,19,24,235,241,254,5,33,17,0,84,92,62,23,48,3,45,93,175,50,116,65,221,33,190,70,14,16,229,25,235,237,98,125,125,124,206,0,221,119,0,221,35,25,12,121,230,15,32,239,225,123,254,119,32,1,28,121,167,32,223,195,171,69,221,54,8,0,205,47,67,10,3,15,135,95,22,0,33,33,33,25,94,35,86,33,33,33,25,221,117,3,221,116,4,24,65,7,7,7,7,221,119,16,24,59,221,119,8,221,119,244,24,51,61,32,7,10,3,221,119,5,24,41,205,19,67,24,36,205,47,67,24,28,221,119,8,221,119,244,196,19,67,10,3,24,184,221,126,6,50,113,66,221,110,250,221,102,251,34,147,66,17,16,32,10,3,131,56,150,130,40,73,56,155,131,40,37,56,173,131,40,179,56,185,198,96,56,32,131,56,193,130,56,15,131,56,192,135,95,33,104,34,25,94,35,86,213,24,208,50,172,70,24,206,221,203,9,134,24,8,221,119,6,221,203,9,198,175,237,115,70,66,221,249,103,111,229,229,229,229,229,229,49,49,49,221,126,5,221,119,15,201,221,203,9,150,10,3,3,3,221,119,10,221,119,249,17,174,71,221,126,6,221,119,7,135,111,38,0,25,126,35,102,111,229,62,62,221,119,6,135,111,38,0,25,94,35,86,225,237,82,221,117,13,221,116,14,221,94,250,221,86,251,62,62,254,6,56,9,17,17,17,221,115,250,221,114,251,10,3,8,10,3,167,40,1,235,237,82,242,174,66,47,8,237,68,8,221,119,12,8,221,119,11,221,54,254,0,201,221,203,9,214,10,3,221,119,10,167,32,7,58,141,66,254,7,159,60,221,119,249,10,3,8,10,3,24,215,10,3,221,119,245,201,10,3,221,119,244,201,10,3,221,119,255,221,119,254,10,3,221,119,0,175,221,119,249,221,119,250,221,119,251,201,10,3,50,161,69,50,171,70,10,3,111,10,3,103,34,164,69,201,10,3,50,69,69,201,221,115,8,50,187,70,10,3,103,10,3,111,34,188,70,175,221,119,244,50,171,70,103,111,34,169,70,201,135,95,22,0,221,114,244,33,33,33,25,94,35,86,33,33,33,25,221,117,1,221,116,2,201,46,67,186,66,79,66,215,66,221,66,227,66,46,67,46,67,251,66,13,67,46,67,46,67,46,67,46,67,46,67,46,67,175,50,184,70,221,203,21,70,229,202,150,68,237,115,225,67,221,110,13,221,102,14,249,209,103,221,126,0,111,57,60,186,56,1,123,221,119,0,221,126,18,134,242,150,67,175,254,96,56,2,62,95,135,8,221,110,15,221,102,16,249,209,38,0,221,126,1,71,135,135,111,57,249,120,60,186,56,1,123,221,119,1,193,225,221,94,8,221,86,9,25,203,112,40,6,221,117,8,221,116,9,235,8,111,38,0,49,174,71,57,249,225,25,221,94,6,221,86,7,25,49,49,49,227,175,221,182,5,40,62,221,53,5,32,57,221,126,22,221,119,5,221,110,23,221,102,24,124,25,221,117,6,221,116,7,221,203,21,86,32,31,221,94,25,221,86,26,167,40,1,235,237,82,250,40,68,221,126,19,221,119,18,175,221,119,5,221,119,6,221,119,7,221,126,2,203,121,40,19,203,113,40,7,254,15,40,11,60,24,5,254,241,40,4,61,221,119,2,111,120,230,15,133,242,75,68,175,254,16,56,2,62,15,221,182,28,111,38,0,17,174,70,25,126,203,65,32,3,221,182,20,50,184,70,203,120,121,40,25,23,23,203,47,203,47,203,47,221,134,4,203,104,40,3,221,119,4,33,133,69,134,119,24,14,31,221,134,3,50,173,70,203,104,40,3,221,119,3,120,31,230,72,33,181,70,182,15,119,225,175,221,182,10,200,221,53,10,192,221,174,21,221,119,21,31,221,126,11,56,3,221,126,12,221,119,10,201,175,50,133,69,50,181,70,61,50,187,70,33,168,70,53,32,127,33,108,70,53,32,76,1,1,1,10,167,32,58,87,50,172,70,42,11,64,35,126,60,32,8,205,34,64,33,33,33,126,60,34,11,64,61,135,95,203,18,33,33,33,25,237,91,168,65,237,115,15,69,249,225,25,68,77,225,25,34,39,69,225,25,34,59,69,49,49,49,221,33,93,70,205,229,65,237,67,209,68,33,137,70,53,32,14,221,33,122,70,1,1,1,205,229,65,237,67,39,69,33,166,70,53,32,14,221,33,151,70,1,1,1,205,229,65,237,67,59,69,62,62,50,168,70,221,33,81,70,42,174,70,205,104,67,34,174,70,58,184,70,50,182,70,221,33,110,70,42,176,70,205,104,67,34,176,70,58,184,70,50,183,70,221,33,139,70,42,178,70,205,104,67,34,178,70,42,172,70,124,133,50,180,70,62,62,95,135,159,87,42,188,70,25,237,91,169,70,25,34,185,70,175,33,171,70,182,40,14,53,32,10,62,62,119,33,33,33,25,34,169,70,175,17,191,255,1,253,255,33,174,70,237,121,67,237,163,66,60,254,13,32,245,237,121,126,167,248,67,237,121,201,100,42,101,0,1,12,1,12,148,53,48,14,96,32,96,33,1,5,9,11,13,15,19,21,25,37,61,0,93,0,49,55,77,83,95,113,130,140,156,158,160,166,168,170,172,174,174,0,87,31,35,37,41,45,47,51,191,0,29,33,35,39,43,45,49,85,189,191,0,27,33,37,41,43,59,77,95,187,189,191,0,1,0,144,13,216,105,112,118,125,133,141,149,157,168,177,187,12,218,98,104,109,117,123,131,138,146,156,164,175,184,14,8,106,114,120,126,134,144,150,160,170,180,190,15,192,120,136,128,144,152,160,176,168,224,176,232,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),function(){function r(r,e,a,s){function t(){this.read=function(r){return _mem[r]},this.write=function(r,e){_mem[r]=e}}return a||(a={}),s||(s={}),new Cowbell.Common.AYGenerator(r,e,function(r,e){for(var t,g=16,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,!1],f=[],o=0,l=Cowbell.Common.buildZ80({}),P=new Uint8Array(65536),d=0;d<Cowbell.Common.PT3PlayerBin.length;d++)P[16384+d]=Cowbell.Common.PT3PlayerBin[d];for(d=0;d<r.length;d++)P[18542+d]=r[d];for(var v=l({memory:{read:function(r){return P[r]},write:function(r,e){P[r]=e}},ioBus:{write:function(r,e){49152==(49154&r)?o=e:32768==(49154&r)&&(n[o]=e,13==o&&(n[14]=!0))}}}),p=v.runRoutine(16384,16128),u=0;1e6>u&&(n[14]=!1,p=v.runRoutine(16389,16128),0===P[16394]);u++)f.push(n.slice());e({ayRegisterLog:f,ayFrequency:s.ayFrequency||a.ayFrequency,commandFrequency:s.commandFrequency||a.commandFrequency,stereoMode:s.stereoMode||a.stereoMode,panning:s.panning||a.panning,ayMode:s.ayMode||a.ayMode})})}Cowbell.Player.ZXPT3=function(e){return new Cowbell.Common.WebAudioPlayer(r,e)}}(),Cowbell.Common.SQTPlayerBin=new Uint8Array([62,8,50,196,68,50,225,68,50,254,68,1,1,1,205,71,65,42,8,80,221,33,196,68,205,145,64,205,138,64,205,138,64,17,63,7,205,128,64,30,0,20,122,254,12,32,245,201,33,27,69,53,32,41,54,1,35,53,126,183,204,226,64,254,4,220,138,64,221,33,196,68,14,36,205,81,65,221,33,225,68,14,18,205,81,65,221,33,254,68,14,9,205,81,65,175,111,103,34,115,64,221,33,196,68,205,27,67,205,27,67,205,27,67,1,0,0,120,23,23,23,177,47,246,0,95,22,7,1,253,255,237,81,6,191,237,89,201,33,12,224,221,33,27,69,126,183,32,8,42,10,80,62,255,50,255,255,70,203,16,221,203,0,174,48,4,221,203,0,238,35,126,230,15,221,119,26,126,230,240,31,31,31,31,254,9,56,3,214,9,47,221,119,24,35,34,139,64,104,38,0,237,91,6,80,25,94,35,86,19,221,115,22,221,114,23,17,29,0,221,25,221,34,143,64,201,58,255,255,238,1,50,255,255,58,222,68,50,207,68,58,251,68,50,236,68,58,24,69,50,9,69,42,218,68,43,70,35,34,214,68,42,247,68,34,243,68,42,20,69,34,16,69,42,220,68,34,216,68,42,249,68,34,245,68,42,22,69,34,18,69,42,139,64,78,35,34,139,64,33,196,68,34,143,64,62,3,22,0,203,166,203,110,40,2,203,230,30,21,25,114,30,8,25,61,32,238,237,67,27,69,121,50,55,64,120,201,221,126,21,183,40,10,221,53,21,221,203,0,126,32,62,201,221,94,18,221,86,19,221,203,0,246,221,203,0,190,26,19,203,127,40,77,221,115,18,221,114,19,71,203,119,40,12,27,221,115,27,221,114,28,230,31,195,181,66,203,111,32,33,230,15,203,96,40,2,237,68,221,134,12,221,119,12,221,94,27,221,86,28,221,203,0,182,26,203,127,32,218,19,195,144,66,230,15,221,119,21,203,96,200,183,40,226,221,203,0,254,24,220,254,96,218,118,66,214,96,254,15,56,17,33,124,64,71,126,177,119,221,203,0,222,120,214,15,202,137,66,61,235,78,35,221,203,0,118,40,10,221,117,18,221,116,19,221,203,0,182,254,8,56,17,221,203,0,198,105,95,22,13,205,128,64,22,11,93,195,128,64,254,6,48,79,221,203,0,102,200,183,32,7,121,230,15,221,119,11,201,61,32,6,121,221,134,11,24,241,61,32,11,121,50,207,68,50,236,68,50,9,69,201,61,32,17,6,3,17,29,0,33,207,68,126,129,230,15,119,25,16,248,201,33,27,69,61,32,11,121,230,31,32,2,62,32,119,195,76,65,126,129,24,242,214,6,6,0,121,72,32,3,5,237,68,221,203,0,214,221,113,13,221,113,14,221,119,15,221,112,16,201,221,119,12,27,221,115,27,221,114,28,19,205,144,66,221,203,0,118,200,221,115,18,221,114,19,201,26,19,203,127,40,28,71,31,230,31,196,181,66,203,112,200,26,230,240,203,24,31,31,31,203,63,196,230,66,26,19,230,15,200,195,222,65,197,135,79,6,0,221,126,0,230,240,221,119,0,42,2,80,9,78,35,70,221,229,225,35,113,35,112,3,3,35,113,35,112,35,54,32,35,34,242,66,193,33,124,64,126,177,169,119,201,135,79,6,0,42,4,80,9,78,35,70,33,0,0,113,35,112,35,3,3,113,35,112,35,54,32,221,203,0,206,201,33,115,64,203,22,35,203,22,221,126,17,198,8,237,121,6,191,237,89,195,49,68,221,110,3,221,102,4,1,253,255,221,86,0,30,0,203,90,32,216,126,230,15,194,60,67,203,66,40,11,30,16,195,66,67,221,150,11,56,1,95,221,126,17,198,8,237,121,6,191,237,89,126,35,230,240,31,31,31,22,6,94,203,19,203,110,40,10,206,0,6,255,237,81,6,191,237,121,123,23,235,33,115,64,203,22,35,23,203,22,235,126,230,31,87,35,94,35,213,22,0,221,53,5,194,162,67,221,110,1,221,102,2,126,35,254,32,78,35,32,8,221,203,0,222,221,203,0,142,71,135,128,95,25,221,113,5,221,117,3,221,116,4,221,126,12,221,203,0,78,40,42,221,110,8,221,102,9,134,35,221,53,10,194,213,67,8,221,110,6,221,102,7,126,35,254,32,88,40,2,78,95,35,25,221,113,10,8,221,117,8,221,116,9,221,134,20,254,45,48,11,135,95,33,55,68,25,86,35,195,242,67,33,100,68,95,25,94,235,209,203,98,203,162,40,2,25,1,237,82,221,203,0,86,40,22,221,78,13,221,70,14,9,235,221,110,15,221,102,16,9,221,117,13,221,116,14,235,221,126,17,135,1,253,255,237,121,6,191,237,105,60,6,255,237,121,6,191,237,97,17,29,0,221,25,201,13,93,12,156,11,231,11,60,10,155,10,2,9,115,8,235,8,107,7,242,7,128,7,20,6,174,6,78,5,244,5,158,5,79,5,1,4,185,4,117,4,53,3,249,3,192,3,138,3,87,3,39,2,250,2,207,2,167,2,129,2,93,2,59,2,27,1,252,1,224,1,197,1,172,1,148,1,125,1,104,1,83,1,64,1,46,1,29,1,13,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95,90,85,80,76,71,67,64,60,57,53,50,48,45,42,40,38,36,34,32,30,28,27,25,24,22,21,20,19,18,17,16,15,14,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,115,207,0,0,0,0,0,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,35,207,0,0,0,0,0,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,113,206,0,0,0,0,0,1,1]),function(){function r(r,e,a,s){function t(){this.read=function(r){return _mem[r]},this.write=function(r,e){_mem[r]=e}}return a||(a={}),s||(s={}),new Cowbell.Common.AYGenerator(r,e,function(r,e){for(var t,g=16,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,!1],f=[],o=0,l=Cowbell.Common.buildZ80({}),P=new Uint8Array(65536),d=0;d<Cowbell.Common.SQTPlayerBin.length;d++)P[16384+d]=Cowbell.Common.SQTPlayerBin[d];for(d=0;d<r.length;d++)P[20480+d]=r[d];var v=(P[20482]|P[20483]<<8)-10,p=20480-v,u=(P[20492]|P[20493]<<8)+p;for(d=20482;d<u;d+=2){var E=(P[d]|P[d+1]<<8)+p;P[d]=255&E,P[d+1]=E>>8}var c=l({memory:{read:function(r){return P[r]},write:function(r,e){P[r]=e}},ioBus:{write:function(r,e){49152==(49154&r)?o=e:32768==(49154&r)&&(n[o]=e,13==o&&(n[14]=!0))}}}),m=c.runRoutine(16384,16128);P[65535]=0;for(var M=0;3e4>M&&(n[14]=!1,m=c.runRoutine(16432,16128),254!=P[65535]);M++)f.push(n.slice());e({ayRegisterLog:f,ayFrequency:s.ayFrequency||a.ayFrequency,commandFrequency:s.commandFrequency||a.commandFrequency,stereoMode:s.stereoMode||a.stereoMode,panning:s.panning||a.panning,ayMode:s.ayMode||a.ayMode})})}Cowbell.Player.ZXSQT=function(e){return new Cowbell.Common.WebAudioPlayer(r,e)}}();